<%= f.hidden_field :selected_opdrecord_id, {class: 'form-control selected_opdrecord'} %>
<div class="row mb30" style="margin-top:20px;">
  <div class="col-md-2">
    Reason for Admission :
  </div>
  <div class="col-md-2" style="margin-top:-5px;">
    <%= f.text_field :admissionreason, {class: "form-control", value: @admission.admissionreason,name: "inpatient_ipd_record[admission_attributes][admissionreason]"} %>
  </div>
  <div class="col-md-2">
    Expected Management :
  </div>
  <div class="col-md-2" style="margin-top:-5px;">
    <% expected_management = (@ipdrecord.read_attribute(:expected_management) if @ipdrecord.present?) %>
    <%= f.input :expected_management, collection: [ 'Surgical', 'Medical' ], :as => :hg_radio_button, :label => false, :required => false, :class => 'btn btn-xs btn-white r-chiefcomplaint', :input_html => {:name => "inpatient_ipd_record[expected_management]" }, :checked => expected_management %>
  </div>
  <div class="col-md-2 ">
    Expected Length Of Stay :
  </div>
  <div class="col-md-2" style="margin-top:-5px; width: 15%">
    <div class="input-group">
      <% expected_stay = @ipdrecord.try(:expected_stay).to_s  %>
      <%= f.number_field :expected_stay, class: 'form-control', value: expected_stay, name: 'inpatient_ipd_record[expected_stay]', min: 0 %>
      <span class="input-group-addon">Days</span>
    </div>
  </div>
</div>
<div class="row mb30">
  <div class="col-md-2 ">
    Date of Injury/Complaints :
  </div>
  <div class="col-md-2" style="margin-top:-5px;">
    <%= f.text_field :complaint_date, {class: "form-control injury_complaint_date",value: @ipdrecord.try(:complaint_date),:name => "inpatient_ipd_record[complaint_date]", readonly: 'readonly', style: 'cursor:pointer;background:#fff;'} %>
  </div>
  <div class="col-md-2 ">
    Date of First OPD Visit :
  </div>
  <div class="col-md-2" style="margin-top:-5px;">
    <%= f.text_field :first_opd_visit, {class: "form-control first_opd_visit",:name => "inpatient_ipd_record[clinical_note_attributes][first_opd_visit]", value: @clinical_note.read_attribute(:first_opd_visit), readonly: 'readonly', style: 'cursor:pointer;background:#fff;'} %>
  </div>
  <div class="col-md-2 ">
    Expected Date of Discharge :
  </div>
  <div class="col-md-2" style="margin-top:-5px;">
    <% dischargedate = @admission.dischargedate.try(:strftime,"%d/%m/%Y")  %>
    <%= f.text_field :discharge_date, {class: "form-control expected_discharge_date", value: dischargedate,:name => "inpatient_ipd_record[discharge_date]", readonly: 'readonly', style: 'cursor:pointer;background:#fff;'} %>
  </div>
</div>
<div class="row mb30">
  <div class="col-md-2 ">
    Payment Type :
  </div>
  <div class="col-md-5">
    <% payment_type = @ipdrecord.checkboxes_checked(@ipdrecord.read_attribute(:payment_type))%>
    <%= f.input :payment_type, collection: ['Cash', 'Credit Card', 'Debit Card', 'Cashless', 'Reimbursement', 'Govt. Scheme'], :as => :hg_checkbox, :label => false, :required => false, :class => 'btn btn-xs btn-white r-chiefcomplaint', style: "margin-top:-2px;", :input_html => {:name => "inpatient_ipd_record[payment_type]" }, :checked => payment_type %>
  </div>
  <div class="col-md-2 cashless-true">
    <!-- <%#= link_to edit_inpatient_insurance_path(id: @tpa.id.to_s), data: {remote: true, 'toggle':  "modal", 'target': '#insurance-modal'}, class: "btn btn-link btn-xs",style: "padding:0px;", id: "isinsured_waiting" do %>Edit Insurance Details<%# end %> -->
  </div>
</div>
<div class="row mb30">
  <div class="col-md-2 ">
    Billing Category :
  </div>
  <div class="col-md-2">
    <%= f.text_field :ipd_billing_category, {class: 'form-control',:name => "inpatient_ipd_record[clinical_note_attributes][ipd_billing_category]",value: @clinical_note.read_attribute(:ipd_billing_category)} %>    
  </div>
  <div class="col-md-2 ">
    Medico-Legal Case :
  </div>
  <div class="col-md-1">
    <% medico_legal_case = @ipdrecord.read_attribute(:medico_legal_case)|| "No" %>
    <%= f.input :medico_legal_case, wrapper_html: {:class=>"primary_assesment_rb medico-legal-case"}, collection: ['Yes', 'No'], :as => :hg_radio_button,:label => false, :required => false, :class => 'btn btn-xs btn-white', style: "margin-top:-2px;", :input_html => {:name => "inpatient_ipd_record[medico_legal_case]" }, :checked => medico_legal_case %>
  </div>
  <div class="col-md-5 medico-legal-details">
    <% medico_legal_details = (@ipdrecord.checkboxes_checked(@ipdrecord.read_attribute(:medico_legal_details)) if @ipdrecord.present?)  %>
    <%= f.input :medico_legal_details, collection: ['MLC report', 'Police FIR', 'Self-Inflicted', 'RTA', 'Substance Abuse', 'Alcohol consumption'], :as => :hg_checkbox, :label => false, :required => false, :class => 'btn btn-xs btn-white medico-legal-details', style: "margin-top:-2px;", :input_html => {:name => "inpatient_ipd_record[medico_legal_details]" }, :checked => medico_legal_details %>
  </div>
</div>
<div class="row mb30">
  <div class="col-md-2 ">
    Comments :
  </div>
  <div class="col-md-3">
    <%= f.text_area :admin_comments, {style: "max-width: 212px !important;max-height: 121px; !important", class: "form-control",:name => "inpatient_ipd_record[clinical_note_attributes][admin_comments]",value: @clinical_note.read_attribute(:admin_comments) }%>
  </div>
  <div class="col-md-1"></div>
</div>



<script type="text/javascript">
  // datepicker
  datepicker_options = {
    changeMonth: true,
    changeYear: true,
    dateFormat: "dd/mm/yy"
  };

  datepicker_options_discharge = {
    changeMonth: true,
    changeYear: true,
    dateFormat: "dd/mm/yy",
    minDate: -0
  }

  $('.injury_complaint_date').datepicker(datepicker_options);
  <% unless @clinical_note.injury_complaint_date.present? %>
    // $(".injury_complaint_date").datepicker("setDate", new Date());
  <% end %>
  $('.first_opd_visit').datepicker(datepicker_options);
  <% unless @clinical_note.first_opd_visit.present? %>
    // $(".first_opd_visit").datepicker("setDate", new Date());
  <% end %>
  $('.expected_discharge_date').datepicker(datepicker_options_discharge);
  <% unless @clinical_note.expected_discharge_date.present? %>
    // $(".expected_discharge_date").datepicker("setDate", new Date());
  <% end %>


  // Show Hide TPA Details
  $(".cashless-true").hide();
  $("#Reimbursement").on('click', function(){
    if($(this).hasClass("btn-darkblue") && !($("#Cashless").hasClass("btn-darkblue"))){
      $(".cashless-true").hide();
    } else {
      $(".cashless-true").show();
    }
  })
  $("#Cashless").on('click', function(){
    if($(this).hasClass("btn-darkblue") && !($("#Reimbursement").hasClass("btn-darkblue"))){
      $(".cashless-true").hide();
    } else {
      $(".cashless-true").show();
    }
  })

  if($("#Reimbursement").hasClass("btn-darkblue") || $("#Cashless").hasClass("btn-darkblue")){
    $(".cashless-true").show();
  } else {
    $(".cashless-true").hide();
  }

  $(".medico-legal-details").hide()
  $(".medico-legal-case").find('button').on('click', function(){
    if($(this).html() == "Yes") {
      $(".medico-legal-details").show()
    } else {
      $(".medico-legal-details").hide()
    }
  })
  if($(".medico-legal-case").find('.btn-brown').html() == 'Yes'){
    $(".medico-legal-details").show() 
  }

  function get_days(date1, date2) { // Format dd/mm/yyyy
    var date1 = new Date(date1.split("/")[2], date1.split("/")[1] - 1, date1.split("/")[0]);
    var date2 = new Date(date2.split("/")[2], date2.split("/")[1] - 1, date2.split("/")[0]);
    return days = ((date1 - date2)/1000/60/60/24)
  }

  $(".expected_discharge_date").on('change', function(){
    var days = get_days($(this).val(), "<%= @admission.admissiondate.strftime('%d/%m/%Y') %>")
    $("#inpatient_ipd_record_expected_stay").val(days)
  }).change();
</script>