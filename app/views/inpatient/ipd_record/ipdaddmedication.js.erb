function _add_button_at_last() {
  var row_count = jQuery("[id^='addnewmedicationbutton']").parents('.treatmentmedications:visible').length
  jQuery("[id^='addnewmedicationbutton']:lt("+(row_count-1)+")").addClass("hidden")
  jQuery("[id^='addnewmedicationbutton']:eq("+(row_count-1)+")").removeClass("hidden")
}

var ipddepartment = jQuery("#ipdrecord_specalityid").val()
if (jQuery(".medication-table-body-added > .treatmentmedications").length == 0){
    if (ipddepartment == "309988001") {              //for opthomology add fields will generates accordingly
      jQuery(".medication-table-body-added").append('<%= escape_javascript(render partial: "templates/common/opthalmology_ipd_medicationset", locals: { i: @counter }) %>')
    }
    else {                                        //for others add fields will generates accordingly
    jQuery(".medication-table-body-added").append('<%= escape_javascript(render partial: "templates/common/orthopedics_ipd_medicationset", locals: { i: @counter }) %>')
    }
  _add_button_at_last()
} else {
    if (ipddepartment == "309988001") {
      jQuery(".medication-table-body-added > .treatmentmedications:last").after('<%= escape_javascript(render partial: "templates/common/opthalmology_ipd_medicationset", locals: {i: @counter}) %>')
    }
    else {
      jQuery(".medication-table-body-added > .treatmentmedications:last").after('<%= escape_javascript(render partial: "templates/common/orthopedics_ipd_medicationset", locals: {i: @counter}) %>')
    }
  _add_button_at_last()
}


_add_button_at_last()