<div class="row">
  <div class="col-xs-12">
    <div class="col-xs-2">
      <div class="title">
        <h5 style="color: #444;font-size: 17px;">Intraocular Pressure</h5>
      </div>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <h5 style="font-size: 14px;"><b>R(OD)</b></h5>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <h5 style="font-size: 14px;"><b>L(OS)</b></h5>
    </div>
  </div>
</div>
<div class="row mb15">
  <div class="col-xs-12">
    <div class="col-xs-2">
      <span>Value :</span>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <div class="col-md-12 col-sm-12">
        <div id="r-intraocularpressure-slider-range" class="r-intraocularpressure-slider-range slider-warning"></div>
      </div>
      <div class="col-md-7 col-sm-7">
        <div class="input-group">
          <%= f.text_field :r_intraocularpressure, class: "form-control r_intraocularpressure" %>
          <span class="input-group-addon">mmHG</span>
        </div>
      </div>
      <div class="col-md-5 col-sm-5">
        <%= f.text_field :r_intraocularpressure_time, class: "form-control r_intraocularpressure_time_a", style: "width:100%;", readonly: "readonly" %>
      </div>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <div class="col-md-12 col-sm-12">
        <div id="l-intraocularpressure-slider-range" class="l-intraocularpressure-slider-range slider-warning"></div>
      </div>
      <div class="col-md-7 col-sm-7">
        <div class="input-group">
          <%= f.text_field :l_intraocularpressure, class: "form-control l_intraocularpressure" %>
          <span class="input-group-addon">mmHG</span>
        </div>
      </div>
      <div class="col-md-5 col-sm-5">
        <%= f.text_field :l_intraocularpressure_time, class: "form-control l_intraocularpressure_time_a", style: "width:100%;", readonly: "readonly" %>
      </div>
    </div>
  </div>
</div>

<div class="row mb15">
  <div class="col-xs-12">
    <div class="col-xs-2">
      <span>Method :</span>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <div class="col-md-5 col-sm-5">
        <%= f.input :r_iop_method, collection: [['AT', 'AT'],['NCT', 'NCT'],['Schiotz', 'Schiotz'],['Perkins', 'Perkins'] ], include_blank: 'Select', label: false, required: false, class: 'btn btn-xs btn-white r_iop_method form-control', input_html: { name: "opdrecord[r_iop_method]", class: "form-control", style: "width: 100%;" }, checked: opdrecord.checkboxes_checked(opdrecord.read_attribute(:r_iop_method)) %>
      </div>
      <div class="col-md-7 col-sm-7">
        <%= f.text_field :r_iop_comments, class: "form-control r_iop_comments", style: 'width: 100%;', placeholder: "Comment" %>
      </div>
    </div>
    <div class="col-xs-3 col-xs-offset-1 text-center">
      <div class="col-md-5 col-sm-5">
        <%= f.input :l_iop_method, collection: [['AT', 'AT'],['NCT', 'NCT'],['Schiotz', 'Schiotz'],['Perkins', 'Perkins'] ], include_blank: 'Select', label: false, required: false, class: 'btn btn-xs btn-white l_iop_method form-control', input_html: { name: "opdrecord[l_iop_method]", class: "form-control",style: "width: 100%;" }, checked: opdrecord.checkboxes_checked(opdrecord.read_attribute(:l_iop_method)) %>
      </div>
      <div class="col-md-7 col-sm-7">
        <%= f.text_field :l_iop_comments, class: "form-control l_iop_comments", style: 'width: 100%;', placeholder: "Comment" %>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  current_time = formatAMPM(new Date())
  $(".r-intraocularpressure-slider-range").slider({
    range: "max",
    min: 0,
    max: 60,
    value: 0,
    slide: function(event, ui) {
      $(".r_intraocularpressure").val(ui.value);
      $(".r_intraocularpressure_time").val(current_time)
      $(".r_intraocularpressure_time_a").val(current_time)
      $(".r-intraocularpressure-slider-range").slider({
        range: "max",
        min: 0,
        max: 60,
        value: ui.value,
      });
    }
  });

  var r_intraocularpressure = "<%= escape_javascript (@opdrecord.read_attribute(:r_intraocularpressure)) %>";
  if (r_intraocularpressure.length > 0) {
    $(".r-intraocularpressure-slider-range").slider("value", r_intraocularpressure);
  }

  $(".r_intraocularpressure").keyup(function(e){
    $(".r_intraocularpressure_time").val(current_time)
    $(".r_intraocularpressure_time_a").val(current_time)
    value = $(this).val()
    $(".r_intraocularpressure").val(value);

    $(".r-intraocularpressure-slider-range").slider({
      range: "max",
      min: 0,
      max: 60,
      value: value,
      slide: function(event, ui) {
        $(".r_intraocularpressure").val(ui.value);
        $(".r_intraocularpressure_time").val(current_time)
        $(".r_intraocularpressure_time_a").val(current_time)
      }
    });
  })

  $(".l-intraocularpressure-slider-range").slider({
    range: "max",
    min: 0,
    max: 60,
    value: 0,
    slide: function(event, ui) {
      $(".l_intraocularpressure").val(ui.value);
      $(".l_intraocularpressure_time").val(current_time)
      $(".l_intraocularpressure_time_a").val(current_time)
      $(".l-intraocularpressure-slider-range").slider({
        range: "max",
        min: 0,
        max: 60,
        value: ui.value,
      });
    }
  });
  var l_intraocularpressure = "<%= escape_javascript (@opdrecord.read_attribute(:l_intraocularpressure)) %>";
  if (l_intraocularpressure.length > 0) {
    $(".l-intraocularpressure-slider-range").slider("value", l_intraocularpressure);
  }

  $(".l_intraocularpressure").keyup(function(e){
    $(".l_intraocularpressure_time").val(current_time)
    $(".l_intraocularpressure_time_a").val(current_time)
    value = $(this).val()
    $(".l_intraocularpressure").val(value);

    $(".l-intraocularpressure-slider-range").slider({
      range: "max",
      min: 0,
      max: 60,
      value: value,
      slide: function(event, ui) {
        $(".l_intraocularpressure").val(ui.value);
        $(".l_intraocularpressure_time").val(current_time)
        $(".l_intraocularpressure_time_a").val(current_time)
      }
    });
  })

  $('[name="opdrecord[r_iop_method]"]').on('change',function(){
    $('[name="opdrecord[r_iop_method]"]').val($(this).val())
  })
  $('[name="opdrecord[l_iop_method]"]').on('change',function(){
    $('[name="opdrecord[l_iop_method]"]').val($(this).val())
  })


  $('[name="opdrecord[r_iop_comments]"]').on('keyup',function(){
    $('.r-iop-comments .note-editable').html($(this).val())
  })
  $('[name="opdrecord[l_iop_comments]"]').on('keyup',function(){
    $('.l-iop-comments .note-editable').html($(this).val())
  })

  $('.r-iop-comments .note-editable').on('keyup',function(){
      $('[name="opdrecord[r_iop_comments]"]').val($(this).code())
  })
  $('.l-iop-comments .note-editable').on('keyup',function(){
      $('[name="opdrecord[l_iop_comments]"]').val($(this).code())
  })


  function formatAMPM(date) {
    var hours = date.getHours();
    var minutes = date.getMinutes();
    var ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12;
    hours = hours ? hours : 12; // the hour '0' should be '12'
    minutes = minutes < 10 ? '0'+minutes : minutes;
    var strTime = hours + ':' + minutes + ' ' + ampm;
    return strTime;
  }
</script>