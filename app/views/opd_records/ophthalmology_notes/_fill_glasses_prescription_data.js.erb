$("#refraction_plus_minus").on("change",function(){
  lasttext.focus();
})


$(".selected-refraction-field").on("focus",function(){
  var sign
  if ($("#refraction_plus_minus").val() == "plus") {
    sign = "plus"
  }
  else {
    sign = "minus"
  }
  $(".refraction-btn").hide()
  if ($(this).hasClass("distant_sph")) {
    $(".refraction-plus-minus").show()
    $(".refraction-distant-sph-"+sign).show()
  }
  if ($(this).hasClass("distant_cyl")) {
    $(".refraction-plus-minus").show()
    $(".refraction-distant-cyl-"+sign).show()
  }
  if ($(this).hasClass("distant_axis")) {
    $(".refraction-distant-axis").show()
  }
  if ($(this).hasClass("distant_vision")) {
    $(".refraction-distant-vision").show()
  }
  if ($(this).hasClass("add_sph")) {
    $(".refraction-add-sph").show()
  }
  if ($(this).hasClass("near_sph")) {
    $(".refraction-plus-minus").show()
    $(".refraction-near-sph-"+sign).show()
  }
  if ($(this).hasClass("near_cyl")) {
    $(".refraction-plus-minus").show()
    $(".refraction-near-cyl-"+sign).show()
  }
  if ($(this).hasClass("near_axis")) {
    $(".refraction-near-axis").show()
  }
  if ($(this).hasClass("near_vision")) {
    $(".refraction-near-vision").show()
  }
})


$(".refraction-btn-class").on("click", function(){
  sometext = $(this).attr("input-value")
  doinsert_ie(sometext)
  return false;
})

$(".refraction-btn-class-ucva").on("click", function(){
  sometext = $(this).attr("input-value")
  doinsert_ie(sometext)
  return false;
})

function focusnext() {
  if ($(lasttext).hasClass("r-selected-refraction-field")) {
    side = "r"
    oposite_side = "l"
  }
  else{
    side = "l"
    oposite_side = "r"
  }
  if ($(lasttext).hasClass("distant_sph")) {
    $("."+side+"_fill_refraction_distant_cyl").focus()
  }
  if ($(lasttext).hasClass("distant_cyl")) {
    $("."+side+"_fill_refraction_distant_axis").focus()
  }
  if ($(lasttext).hasClass("distant_axis")) {
    $("."+side+"_fill_refraction_distant_vision").focus()
  }
  if ($(lasttext).hasClass("distant_vision")) {
    $("."+side+"_fill_refraction_near_sph").focus()
  }
  if ($(lasttext).hasClass("near_sph")) {
    $("."+side+"_fill_refraction_near_cyl").focus()
  }
  if ($(lasttext).hasClass("near_cyl")) {
    $("."+side+"_fill_refraction_near_axis").focus()
  }
  if ($(lasttext).hasClass("near_axis")) {
    $("."+side+"_fill_refraction_near_vision").focus()
  }
  if ($(lasttext).hasClass("near_vision")) {
    $("."+oposite_side+"_fill_refraction_distant_sph").focus()
  }
}
function focusprev() {
  if ($(lasttext).hasClass("r-selected-refraction-field")) {
    side = "r"
    oposite_side = "l"
  }
  else{
    side = "l"
    oposite_side = "r"
  }
  if ($(lasttext).hasClass("distant_cyl")) {
    $("."+side+"_fill_refraction_distant_sph").focus()
  }
  if ($(lasttext).hasClass("distant_axis")) {
    $("."+side+"_fill_refraction_distant_cyl").focus()
  }
  if ($(lasttext).hasClass("distant_vision")) {
    $("."+side+"_fill_refraction_distant_axis").focus()
  }
  if ($(lasttext).hasClass("near_sph")) {
    $("."+side+"_fill_refraction_distant_vision").focus()
  }
  if ($(lasttext).hasClass("near_vision")) {
    $("."+side+"_fill_refraction_near_axis").focus()
  }
  if ($(lasttext).hasClass("near_axis")) {
    $("."+side+"_fill_refraction_near_cyl").focus()
  }
  if ($(lasttext).hasClass("near_cyl")) {
    $("."+side+"_fill_refraction_near_sph").focus()
  }
  if ($(lasttext).hasClass("distant_sph")) {
    $("."+oposite_side+"_fill_refraction_near_vision").focus()
  }
}

$("#next-refraction-btn").on("click",function(){
  focusnext()
})
$("#prev-refraction-btn").on("click",function(){
  focusprev()
})

var lasttext;
var side
var oposite_side
function doinsert_ie(sometext) {
  lasttext.focus();
  lasttext.value = sometext
  $(lasttext).attr("value",sometext)
  focusnext()
}

