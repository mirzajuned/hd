//js for post op
function calculate_post_operative_day(el,el_val){
  // finding element to place counted value
  var day_count_element =  $(el).parents('.postoprecords').find('.post_operative_day_count')

  var today = new Date();

  var dateString = el_val
  var dateParts = dateString.split("/");
  var dateObject = new Date(dateParts[2], dateParts[1] - 1, dateParts[0]); // month is 0-based
  var date_of_operation = new Date(dateObject)
  var timeinmilisec = today.getTime() - date_of_operation.getTime();
  var post_operative_day_count = Math.floor(timeinmilisec / (1000 * 60 * 60 * 24))
  if (post_operative_day_count > 365) {
    var post_operative_year_count = Math.floor(post_operative_day_count / 365)
    var post_operative_month_count = Math.floor((post_operative_day_count % 365) / 30)
    if (post_operative_year_count == 1 && post_operative_month_count == 1 ) {
      $(day_count_element).val(post_operative_year_count+ " Year and "+ post_operative_month_count + " Month")
    }
    else if (post_operative_year_count == 1 && post_operative_month_count == 0 ) {
      $(day_count_element).val(post_operative_year_count+ " Year")
    }
    else if (post_operative_year_count > 1 && post_operative_month_count == 0 ) {
      $(day_count_element).val(post_operative_year_count+ " Years")
    }
    else if (post_operative_year_count > 1 && post_operative_month_count > 1 ) {
      $(day_count_element).val(post_operative_year_count+ " Years and "+ post_operative_month_count + " Months")
    }
    else if (post_operative_year_count == 1 && post_operative_month_count > 1 ) {
      $(day_count_element).val(post_operative_year_count+ " Year and "+ post_operative_month_count + " Months")
    }
    else {
      $(day_count_element).val(post_operative_year_count+ " Years")
    }
  }
  else if (post_operative_day_count >= 30){
    var post_operative_month_count = Math.floor(post_operative_day_count / 30)
    var post_operative_week_count = Math.floor((post_operative_day_count % 30) / 7)
    if (post_operative_month_count == 1 && post_operative_week_count == 1 ) {
      $(day_count_element).val(post_operative_month_count+ " Month and "+ post_operative_week_count + " Week")
    }
    else if (post_operative_month_count == 1 && post_operative_week_count > 1) {
      $(day_count_element).val(post_operative_month_count+ " Month and "+ post_operative_week_count + " Weeks")
    }
    else if (post_operative_month_count == 1 && post_operative_week_count == 0) {
      $(day_count_element).val(post_operative_month_count+ " Month")
    }
    else if (post_operative_month_count > 1 && post_operative_week_count == 0) {
      $(day_count_element).val(post_operative_month_count+ " Months")
    }
    else if (post_operative_month_count > 1 && post_operative_week_count > 1) {
      $(day_count_element).val(post_operative_month_count+ " Months and "+ post_operative_week_count + " Weeks")
    }
    else if (post_operative_month_count > 1 && post_operative_week_count == 1) {
      $(day_count_element).val(post_operative_month_count+ " Months and "+ post_operative_week_count + " Week")
    }
    else {
      $(day_count_element).val(post_operative_month_count+ " Months")
    }
  }
  else if (post_operative_day_count>7){
    var post_operative_week_count = Math.floor(post_operative_day_count / 7)
    var post_operative_day_count = post_operative_day_count % 7
    if (post_operative_week_count == 1 && post_operative_day_count == 1 ) {
      $(day_count_element).val(post_operative_week_count+ " Week and "+ post_operative_day_count + " Day")
    }
    else if (post_operative_week_count > 1 && post_operative_day_count == 0) {
      $(day_count_element).val(post_operative_week_count+ " Weeks")
    }
    else if (post_operative_week_count > 1 && post_operative_day_count > 1) {
      $(day_count_element).val(post_operative_week_count+ " Weeks and "+ post_operative_day_count + " Days")
    }
    else if (post_operative_week_count > 1 && post_operative_day_count == 1) {
      $(day_count_element).val(post_operative_week_count+ " Weeks and "+ post_operative_day_count + " Day")
    }
    else if (post_operative_week_count == 1 && post_operative_day_count > 1) {
      $(day_count_element).val(post_operative_week_count+ " Week and "+ post_operative_day_count + " Days")
    }
    else {
      $(day_count_element).val(post_operative_week_count+ " Weeks")
    }
  }
  else if (post_operative_day_count == 1){
    $(day_count_element).val(post_operative_day_count+ " Day")
  }
  else if (post_operative_day_count <= 7) {
    $(day_count_element).val(post_operative_day_count + " Days")
  }
  else {
    $(day_count_element).val(post_operative_day_count + " Days")
  }
}
$(".post_operative_day_datepicker").on("change", function(e){
  e.preventDefault();
  el_val = $(this).attr("value")
  calculate_post_operative_day(this,el_val)
})

// if ($(".post_operative_day_datepicker").val()){
//   // var post_operative_day_count =  $(this).parents('.postoprecords').find('.post_operative_day_count')
//   el_val = $(this).attr("value")
//   calculate_post_operative_day(this,"11/10/2018")
// }

show_hide_lattice_degeneration("r")
show_hide_lattice_degeneration("l")
function show_hide_lattice_degeneration(side){
  if ($("#opdrecord_"+side+"_fundus_peripheral_lesions_select").val() == "Lattice Degeneration") {
    $("."+side+"_fundus_lattice_degeneration_show_hide").show()
  }
  else {
    deselected_select2tag(side+"_fundus_lattice_degeneration","opdrecord_"+side+"_fundus_lattice_degeneration_select","Select")
    $("."+side+"_fundus_lattice_degeneration_show_hide").hide()
  }
}

$("#opdrecord_r_fundus_peripheral_lesions_select").on("change",function(){
  show_hide_lattice_degeneration("r")
})

$("#opdrecord_r_fundus_media_select").select2()
$("#opdrecord_r_fundus_pvd_select").select2()
$("#opdrecord_r_fundus_optdiscsize_select").select2()
$("#opdrecord_r_fundus_cup_disc_ratio_select").select2()
$("#opdrecord_r_fundus_bloodvessel_select").select2()
$("#opdrecord_r_fundus_vitreous_select").select2()
$("#opdrecord_r_fundus_retinal_detachment_select").select2()
$("#opdrecord_r_fundus_peripheral_lesions_select").select2()
$("#opdrecord_r_fundus_lattice_degeneration_select").select2()

$(".r_fundus_normal").on("click",function(){
  if ($("#opdrecord_r_fundus_normal").val() == "normal"){
    deselected_select2tag("r_fundus_media_select","opdrecord_r_fundus_media_select","Select")
    deselected_select2tag("r_fundus_pvd_select","opdrecord_r_fundus_pvd_select","Select")
    deselected_select2tag("r_fundus_optdiscsize_select","opdrecord_r_fundus_optdiscsize_select","Select")
    deselected_select2tag("r_fundus_macula_select","opdrecord_r_fundus_macula_select","Select")
    deselected_select2tag("r_fundus_bloodvessel","opdrecord_r_fundus_bloodvessel_select","Select")

    deselected_select2tag("r_fundus_vitreous","opdrecord_r_fundus_vitreous_select","Select")
    deselected_select2tag("r_fundus_retinal_detachment","opdrecord_r_fundus_retinal_detachment_select","Select")
    deselected_select2tag("r_fundus_peripheral_lesions","opdrecord_r_fundus_peripheral_lesions_select","Select")
    deselected_select2tag("r_fundus_lattice_degeneration","opdrecord_r_fundus_lattice_degeneration_select","Select")
    deselected_checkbox_defaultvalue("r_fundus_macula_select","opdrecord_r_fundus_macula_select","")
    let r_macula_select = $(opdrecord_r_fundus_macula_select).val()
    show_or_hide_fundus_macula('r', r_macula_select)
    deselected_select2tag("r_fundus_cup_disc_ratio_select","opdrecord_r_fundus_cup_disc_ratio_select","Select")
    fill_comment_textbox("r_fundus_opticdisc_comment","opdrecord_r_fundus_opticdisc_comment","")
    fill_comment_textbox("r_fundus_bloodvessel_comment","opdrecord_r_fundus_bloodvessel_comment","")
    fill_comment_textbox("r_fundus_macula_comment","opdrecord_r_fundus_macula_comment","")
    fill_comment_textbox("r_fundus_vitreous_comment","opdrecord_r_fundus_vitreous_comment","")
    fill_comment_textbox("r_fundus_retinal_detachment_comment","opdrecord_r_fundus_retinal_detachment_comment","")
    fill_comment_textbox("r_fundus_peripheral_lesions_comment","opdrecord_r_fundus_peripheral_lesions_comment","")
    fill_comment_textbox("r_fundustext_comment","opdrecord_r_fundustext_comment","")
  }
  else{
    $("#opdrecord_r_fundus").val("Abnormal")
    $("#opdrecord_r_fundus").attr("value", "Abnormal")

    selected_select2tag("r_fundus_media_select","opdrecord_r_fundus_media_select","Clear")
    selected_select2tag("r_fundus_pvd_select","opdrecord_r_fundus_pvd_select","Absent")
    selected_select2tag("r_fundus_optdiscsize_select","opdrecord_r_fundus_optdiscsize_select","Medium")
    deselected_checkbox_defaultvalue("r_fundus_macula_select","opdrecord_r_fundus_macula_select","Foveal Reflex")
//    selected_select2tag("r_fundus_macula","opdrecord_r_fundus_macula_select","")
//    selected_select2tag("r_fundus_bloodvessel","opdrecord_r_fundus_bloodvessel_select","")
    let r_macula_select = $(opdrecord_r_fundus_macula_select).val()
    show_or_hide_fundus_macula('r', r_macula_select)
    selected_select2tag("r_fundus_cup_disc_ratio_select","opdrecord_r_fundus_cup_disc_ratio_select","0.3")
    fill_comment_textbox("r_fundus_opticdisc_comment","opdrecord_r_fundus_opticdisc_comment","healthy")
    fill_comment_textbox("r_fundus_bloodvessel_comment","opdrecord_r_fundus_bloodvessel_comment","normal")
    fill_comment_textbox("r_fundustext_comment","opdrecord_r_fundustext_comment","within normal limits")

  }
  var fundus_value = jQuery("#opdrecord_r_fundus").val();
  show_or_hide_fundus('r', fundus_value);
});

$("#opdrecord_l_fundus_peripheral_lesions_select").on("change",function(){
  show_hide_lattice_degeneration("l")
})

$("#opdrecord_l_fundus_media_select").select2()
$("#opdrecord_l_fundus_pvd_select").select2()
$("#opdrecord_l_fundus_optdiscsize_select").select2()
$("#opdrecord_l_fundus_cup_disc_ratio_select").select2()
$("#opdrecord_l_fundus_bloodvessel_select").select2()
$("#opdrecord_l_fundus_vitreous_select").select2()
$("#opdrecord_l_fundus_retinal_detachment_select").select2()
$("#opdrecord_l_fundus_peripheral_lesions_select").select2()
$("#opdrecord_l_fundus_lattice_degeneration_select").select2()

$(".l_fundus_normal").on("click",function(){
  if ($("#opdrecord_l_fundus_normal").val() == "normal"){
    deselected_select2tag("l_fundus_media_select","opdrecord_l_fundus_media_select")
    deselected_select2tag("l_fundus_pvd_select","opdrecord_l_fundus_pvd_select")
    deselected_select2tag("l_fundus_optdiscsize_select","opdrecord_l_fundus_optdiscsize_select")
    deselected_select2tag("l_fundus_macula_select","opdrecord_l_fundus_macula_select","Select")
    deselected_select2tag("l_fundus_bloodvessel","opdrecord_l_fundus_bloodvessel_select","Select")
 
    deselected_select2tag("l_fundus_vitreous","opdrecord_l_fundus_vitreous_select","Select")
    deselected_select2tag("l_fundus_retinal_detachment","opdrecord_l_fundus_retinal_detachment_select","Select")
    deselected_select2tag("l_fundus_peripheral_lesions","opdrecord_l_fundus_peripheral_lesions_select","Select")
    deselected_select2tag("l_fundus_lattice_degeneration","opdrecord_l_fundus_lattice_degeneration_select","Select")
    deselected_checkbox_defaultvalue("l_fundus_macula_select","opdrecord_l_fundus_macula_select","")
    let l_macula_select = $(opdrecord_l_fundus_macula_select).val()
    show_or_hide_fundus_macula('l', l_macula_select)
    deselected_select2tag("l_fundus_cup_disc_ratio_select","opdrecord_l_fundus_cup_disc_ratio_select","Select")
    fill_comment_textbox("l_fundus_opticdisc_comment","opdrecord_l_fundus_opticdisc_comment","")
    fill_comment_textbox("l_fundus_bloodvessel_comment","opdrecord_l_fundus_bloodvessel_comment","")
    fill_comment_textbox("l_fundus_macula_comment","opdrecord_l_fundus_macula_comment","")

    fill_comment_textbox("l_fundus_vitreous_comment","opdrecord_l_fundus_vitreous_comment","")
    fill_comment_textbox("l_fundus_retinal_detachment_comment","opdrecord_l_fundus_retinal_detachment_comment","")
    fill_comment_textbox("l_fundus_peripheral_lesions_comment","opdrecord_l_fundus_peripheral_lesions_comment","")
    fill_comment_textbox("l_fundustext_comment","opdrecord_l_fundustext_comment","")
  }
  else{
    $("#opdrecord_l_fundus").val("Abnormal")
    $("#opdrecord_l_fundus").attr("value", "Abnormal")

    selected_select2tag("l_fundus_media_select","opdrecord_l_fundus_media_select","Clear")
    selected_select2tag("l_fundus_pvd_select","opdrecord_l_fundus_pvd_select","Absent")
    selected_select2tag("l_fundus_optdiscsize_select","opdrecord_l_fundus_optdiscsize_select","Medium")
    deselected_checkbox_defaultvalue("l_fundus_macula_select","opdrecord_l_fundus_macula_select","Foveal Reflex")
//    selected_select2tag("l_fundus_bloodvessel","opdrecord_l_fundus_bloodvessel_select","")
    let l_macula_select = $(opdrecord_l_fundus_macula_select).val()
    show_or_hide_fundus_macula('l', l_macula_select)
    selected_select2tag("l_fundus_cup_disc_ratio_select","opdrecord_l_fundus_cup_disc_ratio_select","0.3")
    fill_comment_textbox("l_fundus_opticdisc_comment","opdrecord_l_fundus_opticdisc_comment","healthy")
    fill_comment_textbox("l_fundus_bloodvessel_comment","opdrecord_l_fundus_bloodvessel_comment","normal")
    fill_comment_textbox("l_fundustext_comment","opdrecord_l_fundustext_comment","within normal limits")

  }
  var fundus_value = jQuery("#opdrecord_l_fundus").val();
  show_or_hide_fundus('l', fundus_value);
});

function selected_selecttag(fieldname, input_fieldname,input_text) {
  jQuery("#" + input_fieldname).val(input_text);
}

function selected_select2tag(fieldname, input_fieldname,input_text) {
  jQuery("#" + input_fieldname).val(input_text);
  jQuery("#select2-" + input_fieldname + "-container").html(input_text);
}
function fill_comment_textbox(fieldname, input_fieldname,input_text) {
  jQuery("#" + input_fieldname).val(input_text);
}
function empty_comment_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
    jQuery("#" + input_fieldname).code('')
}
function empty_keratometry_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_lid_margin_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_conjuctiva_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_cornea_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_tear_film_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_surface_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_coverage_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_blink_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_lag_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_push_up_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_rotation_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_sphere_test_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_cylinder_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_axis_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_vision_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_company_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_brand_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function empty_color_textbox(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function deselected_selecttag(fieldname, input_fieldname) {
    jQuery("#" + input_fieldname).val("");
}
function deselected_select2tag(fieldname, input_fieldname,input_text) {
    jQuery("#" + input_fieldname).val("");
    jQuery("#select2-" + input_fieldname + "-container").html(input_text);
}
function deselected_radiobutton(fieldname, input_fieldname, value) {
    jQuery.each(jQuery("." + fieldname), function(index, button) {
        if (jQuery(button).attr("input-value") === value) {
            jQuery(button).addClass("btn-brown");
            jQuery("#" + input_fieldname).val(value);
        } else {
            jQuery(button).removeClass("btn-brown");
            jQuery("#" + input_fieldname).val(value);
        }
    });
}
function deselected_checkbox(fieldname, input_fieldname){
    jQuery.each(jQuery("." + fieldname), function(index, button) {
        if (jQuery(button).hasClass("btn-darkblue")) {
            jQuery(button).removeClass("btn-darkblue");
            jQuery("#" + input_fieldname).val("");
        }
    });
}
function deselected_checkbox_defaultvalue(fieldname, input_fieldname, checkboxvalue){
    jQuery.each(jQuery("." + fieldname), function(index, button) {
        if (jQuery(button).hasClass("btn-darkblue")) {
            jQuery(button).removeClass("btn-darkblue");
            jQuery("#" + input_fieldname).val("");
        }
    });
    jQuery.each(jQuery("." + fieldname), function(index, button) {
        if (jQuery(button).attr("input-value") === checkboxvalue) {
            jQuery(button).addClass("btn-darkblue");
            jQuery("#" + input_fieldname).val(checkboxvalue);
        }
    });
}
function show_or_hide_appearance(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforappearance").hide();
        deselected_radiobutton(side+"_appearance_proptosis", "opdrecord_"+side+"_appearance_proptosis", "No");
        deselected_radiobutton(side+"_appearance_dystopia", "opdrecord_"+side+"_appearance_dystopia", "No");
        deselected_radiobutton(side+"_appearance_injured", "opdrecord_"+side+"_appearance_injured", "No");
        deselected_radiobutton(side+"_appearance_swollen", "opdrecord_"+side+"_appearance_swollen", "No");
        deselected_radiobutton(side+"_appearance_phthisisbulbi", "opdrecord_"+side+"_appearance_phthisisbulbi", "No");
        deselected_radiobutton(side+"_appearance_anophthalmos", "opdrecord_"+side+"_appearance_anophthalmos", "No");
        deselected_radiobutton(side+"_appearance_micropththalmos", "opdrecord_"+side+"_appearance_micropththalmos", "No");
        deselected_radiobutton(side+"_appearance_artificial", "opdrecord_"+side+"_appearance_artificial", "No");
        empty_comment_textbox(side+"_appearance_comments", "opdrecord_"+side+"_appearance_comments");
      $("#buttontoggle-opdrecord_"+side+"_appearance > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforappearance").show();
      $("#buttontoggle-opdrecord_"+side+"_appearance > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
// narender trauma
function select_deselect_structural(side, value){
  if(value == "ANT SEGMENT"){
    $("."+side+"_local_trauma_antsegment").show();
    $("."+side+"_local_trauma_postsegment").hide();
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
  }else if(value == "POST SEGMENT"){
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").show();
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    //deselected_checkbox(side+"_ocular_trauma_antsegment", "")
  }else{
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
  }
}
function select_deselect_pathological(side, value){
  if(value=="OPEN GLOBE"){
    $("."+side+"_local_trauma_openglobe").show();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
  }else if(value=="CLOSED GLOBE"){
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").show();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
  }else if(value=="DESTRUCTIVE GLOBE"){
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").show();
    deselected_checkbox(side+"_ocular_trauma_openglobe","opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
  }else{
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_checkbox(side+"_ocular_trauma_openglobe","opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
  }
}
function select_deselect_global(side, value){
  if(value == "STRUCTURAL"){
      $("."+side+"_local_trauma_structural").show();
      $("."+side+"_local_trauma_openglobe").hide();
      $("."+side+"_local_trauma_pathological").hide();
      $("."+side+"_local_trauma_closedglobe").hide();
      $("."+side+"_local_trauma_destructiveglobe").hide();
      deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
      deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
      deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
      deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
      $("input[name='opdrecord["+side+"_ocular_trauma_structural]']").on('change', function(){
        var ocular_trauma_structural = this.value;
        select_deselect_structural(side, ocular_trauma_structural)
      }).trigger('change');
  }else if(value == "PATHOLOGICAL"){
    $("."+side+"_local_trauma_pathological").show();
    $("input[name='opdrecord["+side+"_ocular_trauma_pathological]']").on('change', function(){
      var ocular_trauma_pathological = this.value;
      select_deselect_pathological(side, ocular_trauma_pathological);
    }).trigger('change');
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
  }else{
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
  }
}

function select_deselect_trauma_mechanical(side, value){
  if(value=="ADNEXAL"){
    $("."+side+"_local_trauma_adnexal").show();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
  }else if(value == "GLOBAL"){
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").show();
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
    $("input[name='opdrecord["+side+"_ocular_trauma_global]']").on('change', function(){
      var ocular_trauma_global = this.value;
      select_deselect_global(side, ocular_trauma_global)
    }).trigger('change');
  }else{
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
  }
}

function show_hide_local_choice_options(side, value){
  if (value == "NON MECHANICAL"){
    $("."+side+"_local_trauma_local_nonmechanical").show();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical","");
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
  }else if(value == "MECHANICAL"){
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").show();
    deselected_checkbox(side+"_ocular_trauma_nonmechanical", "opdrecord_"+side+"_ocular_trauma_nonmechanical", "");
    $("input[name='opdrecord["+side+"_ocular_trauma_mechanical]']").on('change', function(){
      var ocular_trauma_mechanical = this.value
      select_deselect_trauma_mechanical (side, ocular_trauma_mechanical)
    }).trigger('change');
  }else{
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical","");
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
  }
}

function next_step_trauma_injury(side, value){
  if (value == "Local"){
    $("."+side+"_local_trauma_inj").show();
    $("input[name='opdrecord["+side+"_ocular_trauma_local]']").on('change', function(){
      var ocular_trauma_local_value =  this.value;
      show_hide_local_choice_options(side, ocular_trauma_local_value)
    }).trigger('change');
    $("."+side+"_local_trauma_associational").hide();
    $("."+side+"_local_trauma_environmental").hide();
    deselected_radiobutton(side+"_ocular_trauma_environmental", "opdrecord_"+side+"_ocular_trauma_environmental", "")
    deselected_radiobutton(side+"_ocular_trauma_associational", "opdrecord_"+side+"_ocular_trauma_associational", "");
  }else if(value == "Associational"){
    $("."+side+"_local_trauma_associational").show();
    $("."+side+"_local_trauma_environmental").hide();
    deselected_radiobutton(side+"_ocular_trauma_environmental", "opdrecord_"+side+"_ocular_trauma_environmental", "")
    $("."+side+"_local_trauma_inj").hide();
    deselected_radiobutton(side+"_ocular_trauma_local", "opdrecord_"+side+"_ocular_trauma_local","")
    deselected_checkbox(side+"_ocular_trauma_nonmechanical", "opdrecord_"+side+"_ocular_trauma_nonmechanical", "");
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical","");
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
  }else if(value == "Environmental"){
    $("."+side+"_local_trauma_associational").hide();
    $("."+side+"_local_trauma_environmental").show();
    deselected_radiobutton(side+"_ocular_trauma_associational", "opdrecord_"+side+"_ocular_trauma_associational", "");
    $("."+side+"_local_trauma_inj").hide();
    deselected_radiobutton(side+"_ocular_trauma_local", "opdrecord_"+side+"_ocular_trauma_local","")
    deselected_checkbox(side+"_ocular_trauma_nonmechanical", "opdrecord_"+side+"_ocular_trauma_nonmechanical", "");
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical","");
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
  }else{
    $("."+side+"_local_trauma_environmental").hide();
    deselected_radiobutton(side+"_ocular_trauma_environmental", "opdrecord_"+side+"_ocular_trauma_environmental", "")
    $("."+side+"_local_trauma_associational").hide();
    $("."+side+"_local_trauma_environmental").hide();
    deselected_radiobutton(side+"_ocular_trauma_associational", "opdrecord_"+side+"_ocular_trauma_associational", "");
    $("."+side+"_local_trauma_inj").hide();
    deselected_radiobutton(side+"_ocular_trauma_local", "opdrecord_"+side+"_ocular_trauma_local","")
    deselected_checkbox(side+"_ocular_trauma_nonmechanical", "opdrecord_"+side+"_ocular_trauma_nonmechanical", "");
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe","opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_radiobutton(side+"_ocular_trauma_structural","opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_radiobutton(side+"_ocular_trauma_global","opdrecord_"+side+"_ocular_trauma_global","");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical","");
    deselected_checkbox(side+"_ocular_trauma_adnexal","opdrecord_"+side+"_ocular_trauma_adnexal", "")
  }
}
function show_or_hide_ocular_trauma(side, value){
  if (value == "Normal" || value.length == 0){
    jQuery("."+side+"-ocular_trauma").hide();
    $("#opdrecord_"+side+"_ocular_trauma").val("");
    $("#opdrecord_"+side+"_ocular_trauma").val("");
    $("#opdrecord_"+side+"_trauma_comment").val("")
    $("."+side+"_local_trauma_associational").hide();
    $("."+side+"_local_trauma_associational").hide();
    $("."+side+"_local_trauma_environmental").hide();
    $("."+side+"_local_trauma_inj").hide();
    $("."+side+"_local_trauma_local_nonmechanical").hide();
    $("."+side+"_local_trauma_local_mechanical").hide();
    $("."+side+"_local_trauma_adnexal").hide();
    $("."+side+"_local_trauma_global").hide();
    $("."+side+"_local_trauma_structural").hide();
    $("."+side+"_local_trauma_antsegment").hide();
    $("."+side+"_local_trauma_postsegment").hide();
    $("."+side+"_local_trauma_pathological").hide();
    $("."+side+"_local_trauma_openglobe").hide();
    $("."+side+"_local_trauma_closedglobe").hide();
    $("."+side+"_local_trauma_destructiveglobe").hide();
    $("#buttontoggle-opdrecord_"+side+"_ocular_trauma > span").attr('class','glyphicon glyphicon-plus-sign');
    deselected_radiobutton(side+"_ocular_trauma_injury", "opdrecord_"+side+"_ocular_trauma_injury", "");
    deselected_radiobutton(side+"_ocular_trauma_local", "opdrecord_"+side+"_ocular_trauma_local", "");
    deselected_checkbox(side+"_ocular_trauma_nonmechanical", "opdrecord_"+side+"_ocular_trauma_nonmechanical", "");
    deselected_radiobutton(side+"_ocular_trauma_mechanical", "opdrecord_"+side+"_ocular_trauma_mechanical", "");
    deselected_checkbox(side+"_ocular_trauma_adnexal", "opdrecord_"+side+"_ocular_trauma_adnexal", "");
    deselected_radiobutton(side+"_ocular_trauma_global", "opdrecord_"+side+"_ocular_trauma_global", "");
    deselected_radiobutton(side+"_ocular_trauma_structural", "opdrecord_"+side+"_ocular_trauma_structural", "");
    deselected_checkbox(side+"_ocular_trauma_antsegment", "opdrecord_"+side+"_ocular_trauma_antsegment", "");
    deselected_checkbox(side+"_ocular_trauma_postsegment", "opdrecord_"+side+"_ocular_trauma_postsegment", "");
    //deselected_radiobutton(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_checkbox(side+"_ocular_trauma_closedglobe", "opdrecord_"+side+"_ocular_trauma_closedglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_destructiveglobe", "opdrecord_"+side+"_ocular_trauma_destructiveglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_associational", "opdrecord_"+side+"_ocular_trauma_associational", "");
    deselected_radiobutton(side+"_ocular_trauma_environmental", "opdrecord_"+side+"_ocular_trauma_environmental", "");
    deselected_checkbox(side+"_ocular_trauma_openglobe", "opdrecord_"+side+"_ocular_trauma_openglobe", "");
    deselected_radiobutton(side+"_ocular_trauma_pathological", "opdrecord_"+side+"_ocular_trauma_pathological", "");
  }else if (value !== "Normal" || value.length == 0){
    $("."+side+"-ocular_trauma").show();
    $("#buttontoggle-opdrecord_"+side+"_ocular_trauma > span").attr('class','glyphicon glyphicon-minus-sign')
    jQuery("input[name='opdrecord["+side+"_ocular_trauma_injury]']").on('change', function() {
      var ocular_trauma_type = this.value;
      next_step_trauma_injury(side , ocular_trauma_type)
    }).trigger('change');
  }
}

function show_or_hide_conjunctiva(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforconjunctiva").hide();
        deselected_radiobutton(side+"_conjunctiva_congestion", "opdrecord_"+side+"_conjunctiva_congestion", "No");
        deselected_radiobutton(side+"_conjunctiva_conjunctivitis", "opdrecord_"+side+"_conjunctiva_conjunctivitis", "No");
        deselected_radiobutton(side+"_conjunctiva_episcleritis", "opdrecord_"+side+"_conjunctiva_episcleritis", "No");
        deselected_radiobutton(side+"_conjunctiva_tear", "opdrecord_"+side+"_conjunctiva_tear", "No");
        deselected_radiobutton(side+"_conjunctiva_conjuctival_blib", "opdrecord_"+side+"_conjunctiva_conjuctival_blib", "No");
        deselected_radiobutton(side+"_conjunctiva_subconjunctival_haemorrhage", "opdrecord_"+side+"_conjunctiva_subconjunctival_haemorrhage", "No");
        deselected_radiobutton(side+"_conjunctiva_foreign_body", "opdrecord_"+side+"_conjunctiva_foreign_body", "No");

        deselected_radiobutton(side+"_conjunctiva_follicles", "opdrecord_"+side+"_conjunctiva_follicles", "No");
        deselected_radiobutton(side+"_conjunctiva_papillae", "opdrecord_"+side+"_conjunctiva_papillae", "No");
        deselected_radiobutton(side+"_conjunctiva_pinguecula", "opdrecord_"+side+"_conjunctiva_pinguecula", "No");
        deselected_radiobutton(side+"_conjunctiva_pterygium", "opdrecord_"+side+"_conjunctiva_pterygium", "No");
        deselected_radiobutton(side+"_conjunctiva_phlycten", "opdrecord_"+side+"_conjunctiva_phlycten", "No");

        empty_comment_textbox(side+"_conjunctiva_comments", "opdrecord_"+side+"_conjunctiva_comments");
      $("#buttontoggle-opdrecord_"+side+"_conjunctiva > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforconjunctiva").show();
      $("#buttontoggle-opdrecord_"+side+"_conjunctiva > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_cornea(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforcornea").hide();
        deselected_radiobutton(side+"_cornea_size", "opdrecord_"+side+"_cornea_size", "Normal");
        deselected_radiobutton(side+"_cornea_shape", "opdrecord_"+side+"_cornea_shape", "Normal");
        deselected_checkbox_defaultvalue(side+"_cornea_surface", "opdrecord_"+side+"_cornea_surface", "Normal");
        empty_comment_textbox(side+"_cornea_comments", "opdrecord_"+side+"_cornea_comments");
        deselected_selecttag(side+"_cornea_schirmer_test", "opdrecord_"+side+"_cornea_schirmer_test", "Normal");
        empty_comment_textbox(side+"_cornea_schirmer_dimension", "opdrecord_"+side+"_cornea_schirmer_dimension");
        empty_comment_textbox(side+"_cornea_schirmer_time", "opdrecord_"+side+"_cornea_schirmer_time");
      $("#buttontoggle-opdrecord_"+side+"_cornea > span").attr('class','glyphicon glyphicon-plus-sign')

    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforcornea").show();
      $("#buttontoggle-opdrecord_"+side+"_cornea > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_anteriorchamber(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforanteriorchamber").hide();
        deselected_radiobutton(side+"_anteriorchamber_depth", "opdrecord_"+side+"_anteriorchamber_depth", "Normal");
        deselected_radiobutton(side+"_anteriorchamber_reaction", "opdrecord_"+side+"_anteriorchamber_reaction", "No");
        deselected_radiobutton(side+"_anteriorchamber_hyphema", "opdrecord_"+side+"_anteriorchamber_hyphema", "No");
        deselected_radiobutton(side+"_anteriorchamber_hypopyon", "opdrecord_"+side+"_anteriorchamber_hypopyon", "No");
        deselected_radiobutton(side+"_anteriorchamber_foreignbody", "opdrecord_"+side+"_anteriorchamber_foreignbody", "No");
        deselected_radiobutton(side+"_anteriorchamber_cells", "opdrecord_"+side+"_anteriorchamber_cells", "No");
        deselected_radiobutton(side+"_anteriorchamber_flare", "opdrecord_"+side+"_anteriorchamber_flare", "No");
        empty_comment_textbox(side+"_anteriorchamber_comments", "opdrecord_"+side+"_anteriorchamber_comments");

        jQuery("."+side+"_anteriorchamber_depth_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_depth_comment", "opdrecord_"+side+"_anteriorchamber_depth_comment");
        jQuery("."+side+"_anteriorchamber_cells_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_cells_comment", "opdrecord_"+side+"_anteriorchamber_cells_comment");
        jQuery("."+side+"_anteriorchamber_flare_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_flare_comment", "opdrecord_"+side+"_anteriorchamber_flare_comment");
        jQuery("."+side+"_anteriorchamber_hyphema_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_hyphema_comment", "opdrecord_"+side+"_anteriorchamber_hyphema_comment");
        jQuery("."+side+"_anteriorchamber_hypopyon_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_hypopyon_comment", "opdrecord_"+side+"_anteriorchamber_hypopyon_comment");
        jQuery("."+side+"_anteriorchamber_foreignbody_comment").hide();
        empty_comment_textbox(side+"_anteriorchamber_foreignbody_comment", "opdrecord_"+side+"_anteriorchamber_foreignbody_comment");
      $("#buttontoggle-opdrecord_"+side+"_anteriorchamber > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforanteriorchamber").show();
      $("#buttontoggle-opdrecord_"+side+"_anteriorchamber > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_anteriorchamber_depth(side, value) {
  if (value === "Normal" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_depth_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_depth_comment", "opdrecord_"+side+"_anteriorchamber_depth_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_depth_comment").show();
  }
}

function show_or_hide_anteriorchamber_cells(side, value) {
  if (value === "No" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_cells_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_cells_comment", "opdrecord_"+side+"_anteriorchamber_cells_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_cells_comment").show();
  }
}

function show_or_hide_anteriorchamber_flare(side, value) {
  if (value === "No" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_flare_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_flare_comment", "opdrecord_"+side+"_anteriorchamber_flare_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_flare_comment").show();
  }
}

function show_or_hide_anteriorchamber_hyphema(side, value) {
  if (value === "No" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_hyphema_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_hyphema_comment", "opdrecord_"+side+"_anteriorchamber_hyphema_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_hyphema_comment").show();
  }
}

function show_or_hide_anteriorchamber_hypopyon(side, value) {
  if (value === "No" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_hypopyon_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_hypopyon_comment", "opdrecord_"+side+"_anteriorchamber_hypopyon_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_hypopyon_comment").show();
  }
}
function show_or_hide_anteriorchamber_foreignbody(side, value) {
  if (value === "No" || value.length === 0) {
    jQuery("."+side+"_anteriorchamber_foreignbody_comment").hide();
    empty_comment_textbox(side+"_anteriorchamber_foreignbody_comment", "opdrecord_"+side+"_anteriorchamber_foreignbody_comment");
  }
  else if (value !== "Normal") {
    jQuery("."+side+"_anteriorchamber_foreignbody_comment").show();
  }
}


function show_or_hide_pupil(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforpupil").hide();
        deselected_radiobutton(side+"_pupil_shape", "opdrecord_"+side+"_pupil_shape", "Normal");
        deselected_radiobutton(side+"_pupil_reaction_to_light_direct", "opdrecord_"+side+"_pupil_reaction_to_light_direct", "Normal");
        deselected_radiobutton(side+"_pupil_reaction_to_light_consensual", "opdrecord_"+side+"_pupil_reaction_to_light_consensual", "Normal");
        deselected_radiobutton(side+"_pupil_rapd", "opdrecord_"+side+"_pupil_rapd", "No");
        empty_comment_textbox(side+"_pupil_comments", "opdrecord_"+side+"_pupil_comments");
      $("#buttontoggle-opdrecord_"+side+"_pupil > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforpupil").show();
      $("#buttontoggle-opdrecord_"+side+"_pupil > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_iris(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforiris").hide();
        deselected_radiobutton(side+"_iris_shape", "opdrecord_"+side+"_iris_shape", "Normal");
        deselected_radiobutton(side+"_iris_neovascularisation", "opdrecord_"+side+"_iris_neovascularisation", "No");
        deselected_radiobutton(side+"_iris_synechiae", "opdrecord_"+side+"_iris_synechiae", "No");
      $("#buttontoggle-opdrecord_"+side+"_iris > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforiris").show();
      $("#buttontoggle-opdrecord_"+side+"_iris > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_lens(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforlens").hide();
        deselected_radiobutton(side+"_lens_nature", "opdrecord_"+side+"_lens_nature", "Clear");
        deselected_radiobutton(side+"_lens_position", "opdrecord_"+side+"_lens_position", "Central");
        deselected_radiobutton(side+"_lens_size", "opdrecord_"+side+"_lens_size", "Normal");
        empty_comment_textbox(side+"_lens_comments", "opdrecord_"+side+"_lens_comments");
      $("#buttontoggle-opdrecord_"+side+"_lens > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforlens").show();
      $("#buttontoggle-opdrecord_"+side+"_lens > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_contact_lens(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforcontactlens").hide();
        empty_keratometry_textbox(side+"_contact_lens_keratometry", "opdrecord_"+side+"_contact_lens_keratometry");
        empty_lid_margin_textbox(side+"_contact_lens_lid_margin", "opdrecord_"+side+"_contact_lens_lid_margin");
        empty_conjuctiva_textbox(side+"_exam_contact_lens_conjuctiva", "opdrecord_"+side+"_exam_contact_lens_conjuctiva");
        empty_cornea_textbox(side+"_exam_contact_lens_cornea", "opdrecord_"+side+"_exam_contact_lens_cornea");
        empty_tear_film_textbox(side+"_contact_lens_tear_film", "opdrecord_"+side+"_contact_lens_tear_film");
        empty_surface_textbox(side+"_contact_lens_surface", "opdrecord_"+side+"_contact_lens_surface");
        empty_coverage_textbox(side+"_contact_lens_coverage", "opdrecord_"+side+"_contact_lens_coverage");
        empty_blink_textbox(side+"_contact_lens_blink", "opdrecord_"+side+"_contact_lens_blink");
        empty_lag_textbox(side+"_contact_lens_lag", "opdrecord_"+side+"_contact_lens_lag");
        empty_push_up_textbox(side+"_contact_lens_push_up", "opdrecord_"+side+"_contact_lens_push_up");empty_rotation_textbox(side+"_contact_lens_rotation", "opdrecord_"+side+"_contact_lens_rotation");
        empty_sphere_test_textbox(side+"_contact_lens_sphere_test", "opdrecord_"+side+"_contact_lens_sphere_test");
        empty_cylinder_textbox(side+"_contact_lens_cylinder", "opdrecord_"+side+"_contact_lens_cylinder");
        empty_axis_textbox(side+"_contact_lens_axis", "opdrecord_"+side+"_contact_lens_axis");
        empty_vision_textbox(side+"_contact_lens_vision", "opdrecord_"+side+"_contact_lens_vision");empty_company_textbox(side+"_contact_lens_company", "opdrecord_"+side+"_contact_lens_company");
        empty_brand_textbox(side+"_contact_lens_brand", "opdrecord_"+side+"_contact_lens_brand");
        empty_color_textbox(side+"_contact_lens_color", "opdrecord_"+side+"_contact_lens_color");
      $("#buttontoggle-opdrecord_"+side+"_contact_lens > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforcontactlens").show();
      $("#buttontoggle-opdrecord_"+side+"_contact_lens > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_locs_grading(side, value) {
    if (value == "Cataract") {
      jQuery("."+side+"-locs-grading").show();
    }
    else {
      jQuery("."+side+"-locs-grading").hide();
      jQuery("."+side+"-locs-grading").find("select").val("");
    }
}
function show_or_hide_extraocularmovements(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforextraocular").hide();
        deselected_radiobutton(side+"_extraocularmovements_uniocular", "opdrecord_"+side+"_extraocularmovements_uniocular", "Full");
        deselected_radiobutton(side+"_extraocularmovements_binocular", "opdrecord_"+side+"_extraocularmovements_binocular", "Full");
        empty_comment_textbox(side+"_extraocularmovements_comments", "opdrecord_"+side+"_extraocularmovements_comments");
        jQuery("."+side+"-answersforextraocular-tropia").hide();
        jQuery("."+side+"-answersforextraocular-phoria").hide();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontar_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontar_esotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontar_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontar_exotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_phoria").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_phoria").val("");
        jQuery("."+side+"_extraocularmovements_squint").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint").val("");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_prism").val("");
      $("#buttontoggle-opdrecord_"+side+"_extraocularmovements > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforextraocular").show();
      $("#buttontoggle-opdrecord_"+side+"_extraocularmovements > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_extraocularmovements_squint(side, value) {
    if (value === "tropia") {
        jQuery("."+side+"-answersforextraocular-tropia").show();
        jQuery("."+side+"-answersforextraocular-phoria").hide();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery("."+side+"_extraocularmovements_squint_phoria").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_phoria").val("");
    }
    else if (value == "phoria") {
        jQuery("."+side+"-answersforextraocular-tropia").hide();
        jQuery("."+side+"-answersforextraocular-phoria").show();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia").val("");
    }
    else if (value == "prism") {
        jQuery("."+side+"-answersforextraocular-tropia").hide();
        jQuery("."+side+"-answersforextraocular-phoria").hide();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_phoria").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_phoria").val("");
    }
    else if (value == ""){
      jQuery("."+side+"-answersforextraocular-tropia").hide();
      jQuery("."+side+"-answersforextraocular-phoria").hide();
      jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
      jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
      jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
      jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
      jQuery("."+side+"_extraocularmovements_squint_tropia").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia").val("");
      jQuery("."+side+"_extraocularmovements_squint_phoria").removeClass("btn-brown");
      jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_phoria").val("");
    }
}
function show_or_hide_extraocularmovements_squint_tropia(side, value) {
    if (value === "horizontal") {
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").show();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery('.'+side+'-answersforextraocular-tropia-horizontal-esotropia').hide();
        jQuery('.'+side+'-answersforextraocular-tropia-horizontal-exotropia').hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
    }
    else if (value == "vertical") {
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").show();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_paralytic").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_paralytic").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
    }
    else if (value == "paralytic") {
        jQuery("."+side+"-answersforextraocular-tropia-horizontal").hide();
        jQuery("."+side+"-answersforextraocular-tropia-vertical").hide();
        jQuery("."+side+"-answersforextraocular-tropia-paralytic").show();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_vertical").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_vertical").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
    }
}
function show_or_hide_extraocularmovements_squint_tropia_horizontal(side, value) {
    if (value === "esotropia") {
        jQuery("."+side+"-answersforextraocular-tropia-horizontal-esotropia").show();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal-exotropia").hide();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_exotropia").val("");
    }
    else if (value == "exotropia") {
        jQuery("."+side+"-answersforextraocular-tropia-horizontal-esotropia").hide();
        jQuery("."+side+"-answersforextraocular-tropia-horizontal-exotropia").show();
        jQuery("."+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").removeClass("btn-brown");
        jQuery("#" + "opdrecord_"+side+"_extraocularmovements_squint_tropia_horizontal_esotropia").val("");
    }
}
function show_or_hide_fundus(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforfundus").hide();
        empty_comment_textbox(side+"_fundus_comments", "opdrecord_"+side+"_fundus_comments");
      empty_comment_textbox(side+"_fundus_media_comment", "opdrecord_"+side+"_fundus_media_comment");
      empty_comment_textbox(side+"_fundus_cupratio_comment", "opdrecord_"+side+"_fundus_cupratio_comment");
      empty_comment_textbox(side+"_fundus_opticdisc_comment", "opdrecord_"+side+"_fundus_opticdisc_comment");
      empty_comment_textbox(side+"_fundus_bloodvessel_comment", "opdrecord_"+side+"_fundus_bloodvessel_comment");
      empty_comment_textbox(side+"_fundus_macula_comment", "opdrecord_"+side+"_fundus_macula_comment");
      empty_comment_textbox(side+"_fundustext_comment", "opdrecord_"+side+"_fundustext_comment");
      deselected_selecttag(side+"_fundus_media_select", "opdrecord_"+side+"_fundus_media_select");
      deselected_selecttag(side+"_fundus_pvd_select", "opdrecord_"+side+"_fundus_pvd_select");
      deselected_selecttag(side+"_fundus_optdiscsize_select", "opdrecord_"+side+"_fundus_optdiscsize_select");
      $("#buttontoggle-opdrecord_"+side+"_fundus > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforfundus").show();
      $("#buttontoggle-opdrecord_"+side+"_fundus > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_fundus_macula(side, value){
  if (value.length > 0) {
    let macula_foveal_reflex = value.split(",")
    if (jQuery.inArray("Foveal Reflex", macula_foveal_reflex) != -1) {
      jQuery("."+side+"-answersformacula-fovealreflex").show();
    } else {
      jQuery("."+side+"-answersformacula-fovealreflex").hide();
    }
  } else{
    jQuery("."+side+"-answersformacula-fovealreflex").hide();
  }
}

$('#opdrecord_r_fundus_macula_select').on("change", function(){
  let r_macula_select = $(this).val()
  show_or_hide_fundus_macula('r', r_macula_select)
});

$('#opdrecord_l_fundus_macula_select').on("change", function(){
  let l_macula_select = $(this).val()
  show_or_hide_fundus_macula('l', l_macula_select)
});

function show_or_hide_iop(side, value) {
    if (value === "Normal" || value.length === 0) {
      jQuery("."+side+"-answersforiop").hide();
      $("#buttontoggle-opdrecord_"+side+"_iop > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforiop").show();
      $("#buttontoggle-opdrecord_"+side+"_iop > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_gonioscopy(side, value) {
    if (value === "Normal" || value.length === 0) {
      jQuery("."+side+"-answersforgonioscopy").hide();
      $("#buttontoggle-opdrecord_"+side+"_gonioscopy > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforgonioscopy").show();
      $("#buttontoggle-opdrecord_"+side+"_gonioscopy > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}

function show_or_hide_appendages(side, value) {
    if (value === "Normal" || value.length === 0) {
        jQuery("."+side+"-answersforappendages").hide();
        jQuery('.'+side+'-answersforappendages-eyelids').hide();
        jQuery('.'+side+'-answersforappendages-eyelashes').hide();
        jQuery('.'+side+'-answersforappendages-lacrimalsac').hide();
        jQuery('.'+side+'-answersforappendages-syringing').hide();
        deselected_checkbox(side+"_appendages_tests", "opdrecord_"+side+"_appendages_tests");
        deselected_radiobutton(side+"_appendages_eyelids_chalazion", "opdrecord_"+side+"_appendages_eyelids_chalazion", "No");
        deselected_radiobutton(side+"_appendages_eyelids_fb", "opdrecord_"+side+"_appendages_eyelids_fb", "No");
        deselected_radiobutton(side+"_appendages_eyelashes_laceration","opdrecord_"+side+"_appendages_eyelashes_laceration", "No");
        deselected_radiobutton(side+"_appendages_eyelids_contusion", "opdrecord_"+side+"_appendages_eyelids_contusion", "No");
        deselected_radiobutton(side+"_appendages_eyelids_meibomitis", "opdrecord_"+side+"_appendages_eyelids_meibomitis", "No");
        deselected_radiobutton(side+"_appendages_eyelids_ptosis", "opdrecord_"+side+"_appendages_eyelids_ptosis", "No");
        deselected_radiobutton(side+"_appendages_eyelids_swelling", "opdrecord_"+side+"_appendages_eyelids_swelling", "No");
        deselected_radiobutton(side+"_appendages_eyelids_entropion", "opdrecord_"+side+"_appendages_eyelids_entropion", "No");
        deselected_radiobutton(side+"_appendages_eyelids_ectropion", "opdrecord_"+side+"_appendages_eyelids_ectropion", "No");
        deselected_radiobutton(side+"_appendages_eyelids_mass", "opdrecord_"+side+"_appendages_eyelids_mass", "No");
        deselected_radiobutton(side+"_appendages_eyelashes_trichiasis", "opdrecord_"+side+"_appendages_eyelashes_trichiasis", "No");
        deselected_radiobutton(side+"_appendages_eyelashes_dystrichiasis", "opdrecord_"+side+"_appendages_eyelashes_dystrichiasis", "No");
        deselected_radiobutton(side+"_appendages_lacrimalsac_swelling", "opdrecord_"+side+"_appendages_lacrimalsac_swelling", "No");
        deselected_radiobutton(side+"_appendages_lacrimalsac_regurgitation", "opdrecord_"+side+"_appendages_lacrimalsac_regurgitation", "No");
        deselected_radiobutton(side+"_appendages_syringing", "opdrecord_"+side+"_appendages_syringing", "Patent");
        empty_comment_textbox(side+"_appendages_comments", "opdrecord_"+side+"_appendages_comments");
        $("#buttontoggle-opdrecord_"+side+"_appendages > span").attr('class','glyphicon glyphicon-plus-sign')
    }
    else if (value !== "Normal") {
        jQuery("."+side+"-answersforappendages").show();
        jQuery('.'+side+'-answersforappendages-eyelids').hide();
        jQuery('.'+side+'-answersforappendages-eyelashes').hide();
        jQuery('.'+side+'-answersforappendages-lacrimalsac').hide();
        jQuery('.'+side+'-answersforappendages-syringing').hide();
        $("#buttontoggle-opdrecord_"+side+"_appendages > span").attr('class','glyphicon glyphicon-minus-sign')
    }
}
function show_or_hide_appendages_tests(side, values) {
    if (values.length > 0) {
        var appendages_tests = values.split(",");
        if (appendages_tests.length > 0 ) {
            jQuery.each(appendages_tests, function(index, appendages) {
                jQuery("."+side+"-answersforappendages-"+appendages).show();
            });
        }
    }
}

function show_or_hide_confrontation(side, value) {
  if (value === "Normal" || value.length === 0) {
    jQuery("."+side+"-answersforconfrontation").hide();
    empty_comment_textbox(side+"_confrontation_comments", "opdrecord_"+side+"_confrontation_comments");
    $("#buttontoggle-opdrecord_"+side+"_confrontation > span").attr('class','glyphicon glyphicon-plus-sign')
  }
  else if (value !== "Normal") {
    jQuery("."+side+"-answersforconfrontation").show();
    $("#buttontoggle-opdrecord_"+side+"_confrontation > span").attr('class','glyphicon glyphicon-minus-sign')
  }
}

// function show_or_hide_confrontation(side, value) {
//   if (value === "Normal" || value.length === 0) {
//     jQuery("."+side+"-answersforconfrontation").hide();
//     empty_comment_textbox(side+"_confrontation_comments", "opdrecord_"+side+"_confrontation_comments");
//     $("#buttontoggle-opdrecord_"+side+"_confrontation > span").attr('class','glyphicon glyphicon-plus-sign')
//   }
//   else if (value !== "Normal") {
//     jQuery("."+side+"-answersforconfrontation").show();
//     $("#buttontoggle-opdrecord_"+side+"_confrontation > span").attr('class','glyphicon glyphicon-minus-sign')
//   }
// }

function show_or_hide_colorvision(side, value) {
  if (value === "Normal" || value.length === 0) {
    jQuery("."+side+"-answersforcolorvision").hide();
    empty_comment_textbox(side+"_colorvision_comments", "opdrecord_"+side+"_colorvision_comments");
    $("#buttontoggle-opdrecord_"+side+"_colorvision > span").attr('class','glyphicon glyphicon-plus-sign')
  }
  else if (value !== "Normal") {
    jQuery("."+side+"-answersforcolorvision").show();
    $("#buttontoggle-opdrecord_"+side+"_colorvision > span").attr('class','glyphicon glyphicon-minus-sign')
  }
}

function show_or_hide_contrasenstivity(side, value) {
  if (value === "Normal" || value.length === 0) {
    jQuery("."+side+"-answersforcontrasenstivity").hide();
    empty_comment_textbox(side+"_contrasenstivity_comments", "opdrecord_"+side+"_contrasenstivity_comments");
    $("#buttontoggle-opdrecord_"+side+"_contrasenstivity > span").attr('class','glyphicon glyphicon-plus-sign')
  }
  else if (value !== "Normal") {
    jQuery("."+side+"-answersforcontrasenstivity").show();
    $("#buttontoggle-opdrecord_"+side+"_contrasenstivity > span").attr('class','glyphicon glyphicon-minus-sign')
  }
}

function show_or_hide_amsler(side, value) {
  if (jQuery("."+side+"-answersforamsler").css('display') == 'block') {
    jQuery("."+side+"-answersforamsler").hide();
    empty_comment_textbox(side+"_amsler_comments", "opdrecord_"+side+"_amsler_comments");
    $("#buttontoggle-opdrecord_"+side+"_amsler > span").attr('class','glyphicon glyphicon-plus-sign')
  } else if(jQuery("."+side+"-answersforamsler").css('display') == 'none') {
    jQuery("."+side+"-answersforamsler").show();
    $("#buttontoggle-opdrecord_"+side+"_amsler > span").attr('class','glyphicon glyphicon-minus-sign')
  }
}


function set_to_default_func() {
  set_to_default('r', jQuery("input[name='opdrecord[l_appendages_tests]']").val())
  set_to_default('l', jQuery("input[name='opdrecord[l_appendages_tests]']").val())
}

function set_to_default(side,values) {
  if (values.length > 0) {
    var appendages_tests = values.split(",");
    if (appendages_tests.length > 0 ) {
      jQuery.each(appendages_tests, function(index, complaint) {
        jQuery("[name ='"+ side + "_appendages_tests'][id*='" + complaint + "']").on("click", function(){

          deselected_radiobutton(side+"_appendages_" + complaint + "_chalazion", "opdrecord_"+side+"_appendages_eyelids_chalazion", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_ptosis", "opdrecord_"+side+"_appendages_eyelids_ptosis", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_swelling", "opdrecord_"+side+"_appendages_eyelids_swelling", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_entropion", "opdrecord_"+side+"_appendages_eyelids_entropion", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_ectropion", "opdrecord_"+side+"_appendages_eyelids_ectropion", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_mass", "opdrecord_"+side+"_appendages_eyelids_mass", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_trichiasis", "opdrecord_"+side+"_appendages_eyelashes_trichiasis", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_dystrichiasis", "opdrecord_"+side+"_appendages_eyelashes_dystrichiasis", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_swelling", "opdrecord_"+side+"_appendages_lacrimalsac_swelling", "No");
          deselected_radiobutton(side+"_appendages_" + complaint + "_regurgitation", "opdrecord_"+side+"_appendages_lacrimalsac_regurgitation", "No");
          deselected_radiobutton(side+"_appendages_" + complaint, "opdrecord_"+side+"_appendages_syringing", "Patent");

          deselected_radiobutton(side+"_"+complaint+"_diminisheddayvision", "opdrecord_"+side+"_"+complaint+"_diminisheddayvision", "No");
        })
      });
    }
  }
}



function split_underscore_first_value(value){
    var eye_side = value.split("_")[0]; // "r_appendages_tests".split("_")[0] --> outputs "r"
    return eye_side;
}
function init_generalexaminationcomments(field_name) {

}

jQuery(document).ready(function() {

  if (jQuery("input[name='opdrecord[generalexamination]']").val() === "Normal") {
    jQuery(".generalexaminationcomments-input").hide();
  }
  else if (jQuery("input[name='opdrecord[generalexamination]']").val() !== "Normal") {
    jQuery(".generalexaminationcomments-input").show();
  }

  if (jQuery("input[name='opdrecord[squint_evaluation]']").val() == "No") {
    jQuery(".squint_examination").hide();
  }
  else if (jQuery("input[name='opdrecord[squint_evaluation]']").val() == "Yes") {
    jQuery(".squint_examination").show();
  }

  jQuery("input[name='opdrecord[squint_evaluation]']").on('change', function() {
    if (this.value == "No") {
      jQuery(".squint_examination").hide();
    }
    else if (this.value == "Yes") {
      jQuery(".squint_examination").show();
    }
  });

  jQuery('.ocularexaminationcomments-input').hide();

  jQuery("input[name='opdrecord[generalexamination]']").on('change', function() {
    if (this.value === "Normal") {
      jQuery(".generalexaminationcomments-input").hide();
    }
    else if (this.value !== "Normal") {
      jQuery(".generalexaminationcomments-input").show();
    }
  });

  jQuery("input[name='opdrecord[ocularexamination]']").on('change', function() {
    if (this.value === "Normal") {
      jQuery(".ocularexaminationcomments-input").hide();
    }
    else if (this.value !== "Normal") {
      jQuery(".ocularexaminationcomments-input").show();
    }
  });

  // ADDING INTEROCCULAR PRESSURE PARTIALS. THIS FILE IS ALSO USED OPTOMETRIST TEMPLATE. STARTS HERE.
  <%= render partial: "opd_records/ophthalmology_notes/js/eye_opd_record_objective_refraction.js", locals: { opdrecord: @opdrecord } %>
  // ADDING INTEROCCULAR PRESSURE PARTIALS. THIS FILE IS ALSO USED OPTOMETRIST TEMPLATE. ENDS HERE.
  show_or_hide_ocular_trauma('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_ocular_trauma)) %>")
  show_or_hide_ocular_trauma('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_ocular_trauma)) %>")
  show_or_hide_appearance('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_appearance)) %>");
  show_or_hide_appearance('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_appearance)) %>");
  show_or_hide_scleracommon('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_scleracommon)) %>");
  show_or_hide_scleracommon('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_scleracommon)) %>");
  show_or_hide_appendages('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_appendages)) %>");
  show_or_hide_appendages('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_appendages)) %>");
  show_or_hide_appendages_tests('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_appendages_tests)) %>");
  show_or_hide_appendages_tests('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_appendages_tests)) %>");
  show_or_hide_conjunctiva('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_conjunctiva)) %>");
  show_or_hide_conjunctiva('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_conjunctiva)) %>");
  show_or_hide_cornea('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_cornea)) %>");
  show_or_hide_cornea('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_cornea)) %>");
  show_or_hide_anteriorchamber('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber)) %>");
  show_or_hide_anteriorchamber('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber)) %>");
  show_or_hide_anteriorchamber_depth('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_depth)) %>");
  show_or_hide_anteriorchamber_depth('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_depth)) %>");
  show_or_hide_anteriorchamber_cells('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_cells)) %>");
  show_or_hide_anteriorchamber_cells('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_cells)) %>");
  show_or_hide_anteriorchamber_flare('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_flare)) %>");
  show_or_hide_anteriorchamber_flare('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_flare)) %>");
  show_or_hide_anteriorchamber_hyphema('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_hyphema)) %>");
  show_or_hide_anteriorchamber_hyphema('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_hyphema)) %>");
  show_or_hide_anteriorchamber_hypopyon('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_hypopyon)) %>");
  show_or_hide_anteriorchamber_hypopyon('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_hypopyon)) %>");
  show_or_hide_anteriorchamber_foreignbody('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_anteriorchamber_foreignbody)) %>");
  show_or_hide_anteriorchamber_foreignbody('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_anteriorchamber_foreignbody)) %>");

  show_or_hide_pupil('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_pupil)) %>");
  show_or_hide_pupil('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_pupil)) %>");
  show_or_hide_iris('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_iris)) %>");
  show_or_hide_iris('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_iris)) %>");
  show_or_hide_lens('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_lens)) %>");
  show_or_hide_lens('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_lens)) %>");
  show_or_hide_contact_lens('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_contact_lens)) %>");
  show_or_hide_contact_lens('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_contact_lens)) %>");
  show_or_hide_extraocularmovements('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_extraocularmovements)) %>");
  show_or_hide_extraocularmovements('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_extraocularmovements)) %>");
  show_or_hide_extraocularmovements_squint('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_extraocularmovements_squint)) %>");
  show_or_hide_extraocularmovements_squint('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_extraocularmovements_squint)) %>");
  show_or_hide_extraocularmovements_squint_tropia('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_extraocularmovements_squint_tropia)) %>");
  show_or_hide_extraocularmovements_squint_tropia('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_extraocularmovements_squint_tropia)) %>");
  show_or_hide_extraocularmovements_squint_tropia_horizontal('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_extraocularmovements_squint_tropia_horizontal)) %>");
  show_or_hide_extraocularmovements_squint_tropia_horizontal('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_extraocularmovements_squint_tropia_horizontal)) %>");
  show_or_hide_iop('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_iop)) %>");
  show_or_hide_iop('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_iop)) %>");
  show_or_hide_gonioscopy('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_gonioscopy)) %>");
  show_or_hide_gonioscopy('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_gonioscopy)) %>");
  show_or_hide_fundus('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_fundus)) %>");
  show_or_hide_fundus('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_fundus)) %>");
  show_or_hide_fundus_macula('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_fundus_macula_select)) %>");
  show_or_hide_fundus_macula('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_fundus_macula_select)) %>");
  show_or_hide_confrontation('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_confrontation)) %>");
  show_or_hide_confrontation('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_confrontation)) %>");
  show_or_hide_colorvision('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_colorvision)) %>");
  show_or_hide_colorvision('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_colorvision)) %>");
  show_or_hide_contrasenstivity('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_contrasenstivity)) %>");
  show_or_hide_contrasenstivity('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_contrasenstivity)) %>");
  show_or_hide_amsler('r', "<%= escape_javascript (@opdrecord.read_attribute(:r_amsler)) %>");
  show_or_hide_amsler('l', "<%= escape_javascript (@opdrecord.read_attribute(:l_amsler)) %>");

  $("#buttontoggle-opdrecord_r_appearance").on("click",function(){
    if ($("#opdrecord_r_appearance").val() == "Abnormal" ){
      $("#opdrecord_r_appearance").val("Normal")
      $("#opdrecord_r_appearance").attr("value", "Normal")

    }
    else {
      $("#opdrecord_r_appearance").val("Abnormal")
      $("#opdrecord_r_appearance").attr("value", "Abnormal")
    }
    var appearance_value = jQuery("#opdrecord_r_appearance").val();
    show_or_hide_appearance('r', appearance_value);
  })

  $("#buttontoggle-opdrecord_r_scleracommon").on("click",function(){
    if ($("#opdrecord_r_scleracommon").val() == "Abnormal" ){
      $("#opdrecord_r_scleracommon").val("Normal")
      $("#opdrecord_r_scleracommon").attr("value", "Normal")

    }
    else {
      $("#opdrecord_r_scleracommon").val("Abnormal")
      $("#opdrecord_r_scleracommon").attr("value", "Abnormal")
    }
    var sclera_value = jQuery("#opdrecord_r_scleracommon").val();
    show_or_hide_scleracommon('r', sclera_value);
  })
  
  $("#buttontoggle-opdrecord_r_conjunctiva").on("click",function(){
    if ($("#opdrecord_r_conjunctiva").val() == "Abnormal" ){
      $("#opdrecord_r_conjunctiva").val("Normal")
      $("#opdrecord_r_conjunctiva").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_conjunctiva").val("Abnormal")
      $("#opdrecord_r_conjunctiva").attr("value", "Abnormal")
    }
    var conjunctiva_value = jQuery("#opdrecord_r_conjunctiva").val();
    show_or_hide_conjunctiva('r', conjunctiva_value);
  })

  $("#buttontoggle-opdrecord_r_cornea").on("click",function(){
    if ($("#opdrecord_r_cornea").val() == "Abnormal" ){
      $("#opdrecord_r_cornea").val("Normal")
      $("#opdrecord_r_cornea").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_cornea").val("Abnormal")
      $("#opdrecord_r_cornea").attr("value", "Abnormal")
    }
    var cornea_value = jQuery("#opdrecord_r_cornea").val();
    show_or_hide_cornea('r', cornea_value);
  })

  $("#buttontoggle-opdrecord_r_anteriorchamber").on("click",function(){
    if ($("#opdrecord_r_anteriorchamber").val() == "Abnormal" ){
      $("#opdrecord_r_anteriorchamber").val("Normal")
      $("#opdrecord_r_anteriorchamber").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_anteriorchamber").val("Abnormal")
      $("#opdrecord_r_anteriorchamber").attr("value", "Abnormal")
    }
    var anteriorchamber_value = jQuery("#opdrecord_r_anteriorchamber").val();
    show_or_hide_anteriorchamber('r', anteriorchamber_value);
  })

  jQuery("input[name='opdrecord[r_anteriorchamber_depth]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_depth('r', anteriorchamber_value);
  });
  jQuery("input[name='opdrecord[r_anteriorchamber_cells]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_cells('r', anteriorchamber_value);
  });
  jQuery("input[name='opdrecord[r_anteriorchamber_flare]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_flare('r', anteriorchamber_value);
  });
  jQuery("input[name='opdrecord[r_anteriorchamber_hyphema]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_hyphema('r', anteriorchamber_value);
  });
  jQuery("input[name='opdrecord[r_anteriorchamber_hypopyon]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_hypopyon('r', anteriorchamber_value);
  });
  jQuery("input[name='opdrecord[r_anteriorchamber_foreignbody]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_foreignbody('r', anteriorchamber_value);
  });

  $("#buttontoggle-opdrecord_r_pupil").on("click",function(){
    if ($("#opdrecord_r_pupil").val() == "Abnormal" ){
      $("#opdrecord_r_pupil").val("Normal")
      $("#opdrecord_r_pupil").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_pupil").val("Abnormal")
      $("#opdrecord_r_pupil").attr("value", "Abnormal")
    }
    var pupil_value = jQuery("#opdrecord_r_pupil").val();
    show_or_hide_pupil('r', pupil_value);
  })

  $("#buttontoggle-opdrecord_r_iris").on("click",function(){
    if ($("#opdrecord_r_iris").val() == "Abnormal" ){
      $("#opdrecord_r_iris").val("Normal")
      $("#opdrecord_r_iris").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_iris").val("Abnormal")
      $("#opdrecord_r_iris").attr("value", "Abnormal")
    }
    var iris_value = jQuery("#opdrecord_r_iris").val();
    show_or_hide_iris('r', iris_value);
  })

  $("#buttontoggle-opdrecord_r_contact_lens").on("click",function(){
    if ($("#opdrecord_r_contact_lens").val() == "Abnormal" ){
      $("#opdrecord_r_contact_lens").val("Normal")
      $("#opdrecord_r_contact_lens").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_contact_lens").val("Abnormal")
      $("#opdrecord_r_contact_lens").attr("value", "Abnormal")
    }
    var contact_lens_value = jQuery("#opdrecord_r_contact_lens").val();
    show_or_hide_contact_lens('r', contact_lens_value);
  })

  $("#buttontoggle-opdrecord_r_lens").on("click",function(){
    if ($("#opdrecord_r_lens").val() == "Abnormal" ){
      $("#opdrecord_r_lens").val("Normal")
      $("#opdrecord_r_lens").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_lens").val("Abnormal")
      $("#opdrecord_r_lens").attr("value", "Abnormal")
    }
    var lens_value = jQuery("#opdrecord_r_lens").val();
    show_or_hide_lens('r', lens_value);
  })

  $("#buttontoggle-opdrecord_r_extraocularmovements").on("click",function(){
    if ($("#opdrecord_r_extraocularmovements").val() == "Abnormal" ){
      $("#opdrecord_r_extraocularmovements").val("Normal")
      $("#opdrecord_r_extraocularmovements").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_extraocularmovements").val("Abnormal")
      $("#opdrecord_r_extraocularmovements").attr("value", "Abnormal")
    }
    var extraocularmovements_value = jQuery("#opdrecord_r_extraocularmovements").val();
    show_or_hide_extraocularmovements('r', extraocularmovements_value);
  })

  jQuery("input[name='opdrecord[r_lens_nature]']").on('change', function() {
      var locs_grading_value = this.value;
      show_or_hide_locs_grading('r', locs_grading_value);
  });

  var r_lens_nature = "<%= @opdrecord.read_attribute(:r_lens_nature)%>"
  if (r_lens_nature == 'Cataract') {
    jQuery("input[name='opdrecord[r_lens_nature]']").trigger('change');
  }

  jQuery("input[name='opdrecord[r_extraocularmovements]']").on('change', function() {
      var extraocularmovements_value = this.value;
      show_or_hide_extraocularmovements('r', extraocularmovements_value);
  });

  jQuery("input[name='opdrecord[r_extraocularmovements_squint]']").on('change', function() {
      var extraocularmovements_squint_value = this.value;
      show_or_hide_extraocularmovements_squint('r', extraocularmovements_squint_value);
  });

  jQuery("input[name='opdrecord[r_extraocularmovements_squint_tropia]']").on('change', function() {
      var extraocularmovements_squint_tropia_value = this.value;
      show_or_hide_extraocularmovements_squint_tropia('r', extraocularmovements_squint_tropia_value);
  });

  jQuery("input[name='opdrecord[r_extraocularmovements_squint_tropia_horizontal]']").on('change', function() {
      var extraocularmovements_squint_tropia_horizontal_value = this.value;
      show_or_hide_extraocularmovements_squint_tropia_horizontal('r', extraocularmovements_squint_tropia_horizontal_value);
  });

  $("#buttontoggle-opdrecord_r_iop").on("click",function(){
    if ($("#opdrecord_r_iop").val() == "Abnormal" ){
      $("#opdrecord_r_iop").val("Normal")
      $("#opdrecord_r_iop").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_iop").val("Abnormal")
      $("#opdrecord_r_iop").attr("value", "Abnormal")
    }
    var iop_value = jQuery("#opdrecord_r_iop").val();
    show_or_hide_iop('r', iop_value);
  })

  $('.r-iop-comments .note-editable').on('keyup',function(){
      $('[name="opdrecord[r_iop_comments]"]').val($(this).code())
  })
  $('.l-iop-comments .note-editable').on('keyup',function(){
      $('[name="opdrecord[l_iop_comments]"]').val($(this).code())
  })

  $("#buttontoggle-opdrecord_r_gonioscopy").on("click",function(){
    if ($("#opdrecord_r_gonioscopy").val() == "Abnormal" ){
      $("#opdrecord_r_gonioscopy").val("Normal")
      $("#opdrecord_r_gonioscopy").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_gonioscopy").val("Abnormal")
      $("#opdrecord_r_gonioscopy").attr("value", "Abnormal")
    }
    var gonioscopy_value = jQuery("#opdrecord_r_gonioscopy").val();
    show_or_hide_gonioscopy('r', gonioscopy_value);
  })


  $("#buttontoggle-opdrecord_r_fundus").on("click",function(){
    if ($("#opdrecord_r_fundus").val() == "Abnormal" ){
      $("#opdrecord_r_fundus").val("Normal")
      $("#opdrecord_r_fundus").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_fundus").val("Abnormal")
      $("#opdrecord_r_fundus").attr("value", "Abnormal")
    }
    var fundus_value = jQuery("#opdrecord_r_fundus").val();
    show_or_hide_fundus('r', fundus_value);
  })

  $("#buttontoggle-opdrecord_r_confrontation").on("click",function(){
    if ($("#opdrecord_r_confrontation").val() == "Abnormal" ){
      $("#opdrecord_r_confrontation").val("Normal")
      $("#opdrecord_r_confrontation").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_confrontation").val("Abnormal")
      $("#opdrecord_r_confrontation").attr("value", "Abnormal")
    }
    var confrontation_value = jQuery("#opdrecord_r_confrontation").val();
    show_or_hide_confrontation('r', confrontation_value);
  })

  $("#buttontoggle-opdrecord_r_colorvision").on("click",function(){
    if ($("#opdrecord_r_colorvision").val() == "Abnormal" ){
      $("#opdrecord_r_colorvision").val("Normal")
      $("#opdrecord_r_colorvision").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_colorvision").val("Abnormal")
      $("#opdrecord_r_colorvision").attr("value", "Abnormal")
    }
    var colorvision_value = jQuery("#opdrecord_r_colorvision").val();
    show_or_hide_colorvision('r', colorvision_value);
  })

  $("#buttontoggle-opdrecord_r_contrasenstivity").on("click",function(){
    if ($("#opdrecord_r_contrasenstivity").val() == "Abnormal" ){
      $("#opdrecord_r_contrasenstivity").val("Normal")
      $("#opdrecord_r_contrasenstivity").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_contrasenstivity").val("Abnormal")
      $("#opdrecord_r_contrasenstivity").attr("value", "Abnormal")
    }
    var contrasenstivity_value = jQuery("#opdrecord_r_contrasenstivity").val();
    show_or_hide_contrasenstivity('r', contrasenstivity_value);
  })

  $("#buttontoggle-opdrecord_r_amsler").on("click",function(){
    var amsler_value = jQuery("#opdrecord_r_amsler").val();
    show_or_hide_amsler('r', amsler_value);
  });

  $("#buttontoggle-opdrecord_r_appendages").on("click",function(){
    if ($("#opdrecord_r_appendages").val() == "Abnormal" ){
      $("#opdrecord_r_appendages").val("Normal")
      $("#opdrecord_r_appendages").attr("value", "Normal")
    }
    else {
      $("#opdrecord_r_appendages").val("Abnormal")
      $("#opdrecord_r_appendages").attr("value", "Abnormal")
    }
    var appendages_value = jQuery("#opdrecord_r_appendages").val();
    show_or_hide_appendages('r', appendages_value);
  })

  jQuery('.r_appendages_tests').on("click", function(){
      var appendages=$(this).attr("data-value");
      jQuery(".r-answersforappendages-"+appendages).slideToggle();
      set_to_default_func()
  });

  $("#buttontoggle-opdrecord_l_appearance").on("click",function(){
    if ($("#opdrecord_l_appearance").val() == "Abnormal" ){
      $("#opdrecord_l_appearance").val("Normal")
      $("#opdrecord_l_appearance").attr("value", "Normal")

    }
    else {
      $("#opdrecord_l_appearance").val("Abnormal")
      $("#opdrecord_l_appearance").attr("value", "Abnormal")
    }
    var appearance_value = jQuery("#opdrecord_l_appearance").val();
    show_or_hide_appearance('l', appearance_value);
  })

  $("#buttontoggle-opdrecord_l_scleracommon").on("click",function(){
    if ($("#opdrecord_l_scleracommon").val() == "Abnormal" ){
      $("#opdrecord_l_scleracommon").val("Normal")
      $("#opdrecord_l_scleracommon").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_scleracommon").val("Abnormal")
      $("#opdrecord_l_scleracommon").attr("value", "Abnormal")
    }
    var sclera_value = jQuery("#opdrecord_l_scleracommon").val();
    show_or_hide_scleracommon('l', sclera_value);
  })
  // narener
  $('#buttontoggle-opdrecord_l_ocular_trauma').on('click', function(){
    if($("#opdrecord_l_ocular_trauma").val() == "Abnormal"){
      $("#opdrecord_l_ocular_trauma").val("Normal")
      $("#opdrecord_l_ocular_trauma").attr("value", "Normal")

    }else{
      $("#opdrecord_l_ocular_trauma").val("Abnormal")
      $("#opdrecord_l_ocular_trauma").attr("value", "Abnormal")
    }
    var trauma_value = jQuery("#opdrecord_l_ocular_trauma").val();
    show_or_hide_ocular_trauma('l', trauma_value);
  })

  $("#buttontoggle-opdrecord_r_ocular_trauma").on('click', function(){
    if($("#opdrecord_r_ocular_trauma").val() == "Abnormal"){
      $("#opdrecord_r_ocular_trauma").val("Normal")
      $("#opdrecord_r_ocular_trauma").attr("value", "Normal")
    }else{
      $("#opdrecord_r_ocular_trauma").val("Abnormal")
      $("#opdrecord_r_ocular_trauma").attr("value", "Abnormal")
    }
    var trauma_value_r = jQuery("#opdrecord_r_ocular_trauma").val();
    show_or_hide_ocular_trauma('r', trauma_value_r);
  })
  //
  $("#buttontoggle-opdrecord_l_conjunctiva").on("click",function(){
    if ($("#opdrecord_l_conjunctiva").val() == "Abnormal" ){
      $("#opdrecord_l_conjunctiva").val("Normal")
      $("#opdrecord_l_conjunctiva").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_conjunctiva").val("Abnormal")
      $("#opdrecord_l_conjunctiva").attr("value", "Abnormal")
    }
    var conjunctiva_value = jQuery("#opdrecord_l_conjunctiva").val();
    show_or_hide_conjunctiva('l', conjunctiva_value);
  })

  $("#buttontoggle-opdrecord_l_cornea").on("click",function(){
    if ($("#opdrecord_l_cornea").val() == "Abnormal" ){
      $("#opdrecord_l_cornea").val("Normal")
      $("#opdrecord_l_cornea").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_cornea").val("Abnormal")
      $("#opdrecord_l_cornea").attr("value", "Abnormal")
    }
    var cornea_value = jQuery("#opdrecord_l_cornea").val();
    show_or_hide_cornea('l', cornea_value);
  })

  $("#buttontoggle-opdrecord_l_anteriorchamber").on("click",function(){
    if ($("#opdrecord_l_anteriorchamber").val() == "Abnormal" ){
      $("#opdrecord_l_anteriorchamber").val("Normal")
      $("#opdrecord_l_anteriorchamber").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_anteriorchamber").val("Abnormal")
      $("#opdrecord_l_anteriorchamber").attr("value", "Abnormal")
    }
    var anteriorchamber_value = jQuery("#opdrecord_l_anteriorchamber").val();
    show_or_hide_anteriorchamber('l', anteriorchamber_value);
  })

  jQuery("input[name='opdrecord[l_anteriorchamber_depth]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_depth('l', anteriorchamber_value);
  });

  jQuery("input[name='opdrecord[l_anteriorchamber_cells]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_cells('l', anteriorchamber_value);
  });

  jQuery("input[name='opdrecord[l_anteriorchamber_flare]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_flare('l', anteriorchamber_value);
  });

  jQuery("input[name='opdrecord[l_anteriorchamber_hyphema]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_hyphema('l', anteriorchamber_value);
  });

  jQuery("input[name='opdrecord[l_anteriorchamber_hypopyon]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_hypopyon('l', anteriorchamber_value);
  });

  jQuery("input[name='opdrecord[l_anteriorchamber_foreignbody]']").on('change', function() {
    var anteriorchamber_value = this.value;
    show_or_hide_anteriorchamber_foreignbody('l', anteriorchamber_value);
  });

  $("#buttontoggle-opdrecord_l_pupil").on("click",function(){
    if ($("#opdrecord_l_pupil").val() == "Abnormal" ){
      $("#opdrecord_l_pupil").val("Normal")
      $("#opdrecord_l_pupil").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_pupil").val("Abnormal")
      $("#opdrecord_l_pupil").attr("value", "Abnormal")
    }
    var pupil_value = jQuery("#opdrecord_l_pupil").val();
    show_or_hide_pupil('l', pupil_value);
  })

  $("#buttontoggle-opdrecord_l_iris").on("click",function(){
    if ($("#opdrecord_l_iris").val() == "Abnormal" ){
      $("#opdrecord_l_iris").val("Normal")
      $("#opdrecord_l_iris").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_iris").val("Abnormal")
      $("#opdrecord_l_iris").attr("value", "Abnormal")
    }
    var iris_value = jQuery("#opdrecord_l_iris").val();
    show_or_hide_iris('l', iris_value);
  })

  $("#buttontoggle-opdrecord_l_contact_lens").on("click",function(){
    if ($("#opdrecord_l_contact_lens").val() == "Abnormal" ){
      $("#opdrecord_l_contact_lens").val("Normal")
      $("#opdrecord_l_contact_lens").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_contact_lens").val("Abnormal")
      $("#opdrecord_l_contact_lens").attr("value", "Abnormal")
    }
    var contact_lens_value = jQuery("#opdrecord_l_contact_lens").val();
    show_or_hide_contact_lens('l', contact_lens_value);
  })

  $("#buttontoggle-opdrecord_l_lens").on("click",function(){
    if ($("#opdrecord_l_lens").val() == "Abnormal" ){
      $("#opdrecord_l_lens").val("Normal")
      $("#opdrecord_l_lens").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_lens").val("Abnormal")
      $("#opdrecord_l_lens").attr("value", "Abnormal")
    }
    var lens_value = jQuery("#opdrecord_l_lens").val();
    show_or_hide_lens('l', lens_value);
  })

  $("#buttontoggle-opdrecord_l_extraocularmovements").on("click",function(){
    if ($("#opdrecord_l_extraocularmovements").val() == "Abnormal" ){
      $("#opdrecord_l_extraocularmovements").val("Normal")
      $("#opdrecord_l_extraocularmovements").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_extraocularmovements").val("Abnormal")
      $("#opdrecord_l_extraocularmovements").attr("value", "Abnormal")
    }
    var extraocularmovements_value = jQuery("#opdrecord_l_extraocularmovements").val();
    show_or_hide_extraocularmovements('l', extraocularmovements_value);
  })

  jQuery("input[name='opdrecord[l_lens_nature]']").on('change', function() {
    var locs_grading_value = this.value;
    show_or_hide_locs_grading('l', locs_grading_value);
  });

  var l_lens_nature = "<%= @opdrecord.read_attribute(:l_lens_nature)%>"
  if (l_lens_nature == 'Cataract') {
    jQuery("input[name='opdrecord[l_lens_nature]']").trigger('change');
  }

  jQuery("input[name='opdrecord[l_extraocularmovements]']").on('change', function() {
    var extraocularmovements_value = this.value;
    show_or_hide_extraocularmovements('l', extraocularmovements_value);
  });

  jQuery("input[name='opdrecord[l_extraocularmovements_squint]']").on('change', function() {
    var extraocularmovements_squint_value = this.value;
    show_or_hide_extraocularmovements_squint('l', extraocularmovements_squint_value);
  });

  jQuery("input[name='opdrecord[l_extraocularmovements_squint_tropia]']").on('change', function() {
    var extraocularmovements_squint_tropia_value = this.value;
    show_or_hide_extraocularmovements_squint_tropia('l', extraocularmovements_squint_tropia_value);
  });

  jQuery("input[name='opdrecord[l_extraocularmovements_squint_tropia_horizontal]']").on('change', function() {
    var extraocularmovements_squint_tropia_horizontal_value = this.value;
    show_or_hide_extraocularmovements_squint_tropia_horizontal('l', extraocularmovements_squint_tropia_horizontal_value);
  });

  $("#buttontoggle-opdrecord_l_iop").on("click",function(){
    if ($("#opdrecord_l_iop").val() == "Abnormal" ){
      $("#opdrecord_l_iop").val("Normal")
      $("#opdrecord_l_iop").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_iop").val("Abnormal")
      $("#opdrecord_l_iop").attr("value", "Abnormal")
    }
    var iop_value = jQuery("#opdrecord_l_iop").val();
    show_or_hide_iop('l', iop_value);
  })

  $("#buttontoggle-opdrecord_l_gonioscopy").on("click",function(){
    if ($("#opdrecord_l_gonioscopy").val() == "Abnormal" ){
      $("#opdrecord_l_gonioscopy").val("Normal")
      $("#opdrecord_l_gonioscopy").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_gonioscopy").val("Abnormal")
      $("#opdrecord_l_gonioscopy").attr("value", "Abnormal")
    }
    var gonioscopy_value = jQuery("#opdrecord_l_gonioscopy").val();
    show_or_hide_gonioscopy('l', gonioscopy_value);
  })


  $("#buttontoggle-opdrecord_l_fundus").on("click",function(){
    if ($("#opdrecord_l_fundus").val() == "Abnormal" ){
      $("#opdrecord_l_fundus").val("Normal")
      $("#opdrecord_l_fundus").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_fundus").val("Abnormal")
      $("#opdrecord_l_fundus").attr("value", "Abnormal")
    }
    var fundus_value = jQuery("#opdrecord_l_fundus").val();
    show_or_hide_fundus('l', fundus_value);
  })

  $("#buttontoggle-opdrecord_l_confrontation").on("click",function(){
    if ($("#opdrecord_l_confrontation").val() == "Abnormal" ){
      $("#opdrecord_l_confrontation").val("Normal")
      $("#opdrecord_l_confrontation").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_confrontation").val("Abnormal")
      $("#opdrecord_l_confrontation").attr("value", "Abnormal")
    }
    var confrontation_value = jQuery("#opdrecord_l_confrontation").val();
    show_or_hide_confrontation('l', confrontation_value);
  })

  $("#buttontoggle-opdrecord_l_amsler").on("click",function(){
    let amsler_value = jQuery("#opdrecord_l_amsler").val();
    show_or_hide_amsler('l', amsler_value);
  });

  $("#buttontoggle-opdrecord_l_colorvision").on("click",function(){
    if ($("#opdrecord_l_colorvision").val() == "Abnormal" ){
      $("#opdrecord_l_colorvision").val("Normal")
      $("#opdrecord_l_colorvision").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_colorvision").val("Abnormal")
      $("#opdrecord_l_colorvision").attr("value", "Abnormal")
    }
    var colorvision_value = jQuery("#opdrecord_l_colorvision").val();
    show_or_hide_colorvision('l', colorvision_value);
  })

  $("#buttontoggle-opdrecord_l_contrasenstivity").on("click",function(){
    if ($("#opdrecord_l_contrasenstivity").val() == "Abnormal" ){
      $("#opdrecord_l_contrasenstivity").val("Normal")
      $("#opdrecord_l_contrasenstivity").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_contrasenstivity").val("Abnormal")
      $("#opdrecord_l_contrasenstivity").attr("value", "Abnormal")
    }
    var contrasenstivity_value = jQuery("#opdrecord_l_contrasenstivity").val();
    show_or_hide_contrasenstivity('l', contrasenstivity_value);
  })

  $("#buttontoggle-opdrecord_l_appendages").on("click",function(){
    if ($("#opdrecord_l_appendages").val() == "Abnormal" ){
      $("#opdrecord_l_appendages").val("Normal")
      $("#opdrecord_l_appendages").attr("value", "Normal")
    }
    else {
      $("#opdrecord_l_appendages").val("Abnormal")
      $("#opdrecord_l_appendages").attr("value", "Abnormal")
    }
    var appendages_value = jQuery("#opdrecord_l_appendages").val();
    show_or_hide_appendages('l', appendages_value);
  })

  jQuery('.l_appendages_tests').on("click", function(){
    var appendages = jQuery(this).attr("data-value");
    jQuery(".l-answersforappendages-"+appendages).slideToggle();
    set_to_default_func()
  });

  jQuery(".addappendagesdiagram").on("click", function(event) {
    event.preventDefault();
    var eyeside = jQuery(this).attr("data-eye_side");
    var params = { eyeside: eyeside, diagram_type: "appendages" , patient_id: $(".patient_id").val()};
    jQuery.ajax({
      type: "GET",
      url: "/opd_records/add_appendages_diagram",
      data: {ajax: params, remote: true}
    });
    return false;
  });

  jQuery(".r_cornea_surface").on('click', function() {
    var clickedbutton = this;
    if (jQuery(clickedbutton).attr("input-value") === "Normal") {
      if (jQuery(clickedbutton).hasClass("btn-darkblue")) {
        jQuery(clickedbutton).removeClass("btn-darkblue");
        jQuery("#opdrecord_r_cornea_surface").val("");
      } else {
        jQuery(".r_cornea_surface").removeClass("btn-darkblue");
        jQuery("#opdrecord_r_cornea_surface").val("");
      }
    } else if (jQuery(clickedbutton).attr("input-value") !== "Normal") {
      jQuery.each(jQuery(".r_cornea_surface"), function(index, button) {
        if (jQuery(button).attr("input-value") === "Normal" && jQuery(button).hasClass("btn-darkblue")) {
          jQuery(button).removeClass("btn-darkblue");
          jQuery("#opdrecord_r_cornea_surface").val("");
        }
      });
    }
  });

  jQuery(".l_cornea_surface").on('click', function() {
    var clickedbutton = this;
    if (jQuery(clickedbutton).attr("input-value") === "Normal") {
      if (jQuery(clickedbutton).hasClass("btn-darkblue")) {
        jQuery(clickedbutton).removeClass("btn-darkblue");
        jQuery("#opdrecord_l_cornea_surface").val("");
      } else {
        jQuery(".l_cornea_surface").removeClass("btn-darkblue");
        jQuery("#opdrecord_l_cornea_surface").val("");
      }
    } else if (jQuery(clickedbutton).attr("input-value") !== "Normal") {
      jQuery.each(jQuery(".l_cornea_surface"), function(index, button) {
        if (jQuery(button).attr("input-value") === "Normal" && jQuery(button).hasClass("btn-darkblue")) {
          jQuery(button).removeClass("btn-darkblue");
          jQuery("#opdrecord_l_cornea_surface").val("");
        }
      });
    }
  });

  jQuery(".addcorneadiagram").on("click", function(event) {
    event.preventDefault();
    var eyeside = jQuery(this).attr("data-eye_side");
    var params = { eyeside: eyeside, diagram_type: "cornea" , patient_id: $(".patient_id").val()};
    jQuery.ajax({
      type: "GET",
      url: "/opd_records/add_cornea_diagram",
      data: {ajax: params, remote: true}
    });
    return false;
  });

  jQuery(".addcorneaslitdiagram").on("click", function(event) {
    event.preventDefault();
    var eyeside = jQuery(this).attr("data-eye_side");
    var params = { eyeside: eyeside, diagram_type: "corneaslit" , patient_id: $(".patient_id").val() };

    jQuery.ajax({
      type: "GET",
      url: "/opd_records/add_cornea_slit_diagram",
      data: {ajax: params, remote: true}
    });
    return false;
  });

  jQuery(".add_lens_diagram").on("click", function(event) {
    event.preventDefault();
    var eyeside = jQuery(this).attr("data-eye_side");
    var params = { eyeside: eyeside, diagram_type: "lens", patient_id: $(".patient_id").val() };

    jQuery.ajax({
      type: "GET",
      url: "/opd_records/add_lens_diagram",
      data: { ajax: params, remote: true }
    });
    return false;
  });

  jQuery(".addfundusdiagram").on("click", function(event) {
    event.preventDefault();
    var eyeside = jQuery(this).attr("data-eye_side");
    var params = { eyeside: eyeside, diagram_type: "fundus", patient_id: $(".patient_id").val()};
    jQuery.ajax({
      type: "GET",
      url: "/opd_records/add_fundus_diagram",
      data: {ajax: params, remote: true}
    });
    return false;
  });

  // (exam) code for clearing the radio button
  if ($("#opdrecord_r_extraocularmovements_squint").val() == ""){
    $("#clear_r_squint").hide()
  }
  else{
    $("#clear_r_squint").show()
  }

  $(".r_extraocularmovements_squint").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_r_extraocularmovements_squint").val() == ""){
        $("#clear_r_squint").hide()
      }
      else{
        $("#clear_r_squint").show()
      }
    }, 200);
  });

  $("#clear_r_squint").on("click",function(){
    deselected_radiobutton("r_extraocularmovements_squint", "opdrecord_r_extraocularmovements_squint", "");
    show_or_hide_extraocularmovements_squint("r","")

    $("#clear_r_squint").hide()
  });

// (exam) code for clearing the radio button
  if ($("#opdrecord_l_extraocularmovements_squint").val() == ""){
    $("#clear_l_squint").hide()
  }
  else{
    $("#clear_l_squint").show()
  }

  $(".l_extraocularmovements_squint").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_l_extraocularmovements_squint").val() == ""){
        $("#clear_l_squint").hide()
      }
      else{

        $("#clear_l_squint").show()
      }
    }, 200);
  });

  $("#clear_l_squint").on("click",function(){
    deselected_radiobutton("l_extraocularmovements_squint", "opdrecord_l_extraocularmovements_squint", "");
    show_or_hide_extraocularmovements_squint("l","")
    $("#clear_l_squint").hide()
  });

  $(".options_for_congestion_l").hide()
  $('.l_conjunctiva_congestion').last().on('click', function(){
    $(".options_for_congestion_l").show()
  })
  $('.l_conjunctiva_congestion').first().on('click', function(){
    $(".options_for_congestion_l").hide()
  })
  $(".options_for_congestion_r").hide()
  $('.r_conjunctiva_congestion').last().on('click', function(){
    $(".options_for_congestion_r").show()
  })
  $('.r_conjunctiva_congestion').first().on('click', function(){
    $(".options_for_congestion_r").hide()
  })

  if($('.l_conjunctiva_congestion').last().hasClass("btn-brown")){
    $(".options_for_congestion_l").show()
  } else {
    $(".options_for_congestion_l").hide()
  }
  if($('.r_conjunctiva_congestion').last().hasClass("btn-brown")){
    $(".options_for_congestion_r").show()
  } else {
    $(".options_for_congestion_r").hide()
  }

  <%= render partial: "templates/common/js/popup_modal_shown.js" %>

  validate_squint_values()
});

// Squint Section Js Starts
if ($("#opdrecord_specs_prescription").val() == ""){
  $("#clear_specs_prescription").hide()
} else{
  $("#clear_specs_prescription").show()
}

$(".specs_prescription").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_specs_prescription").val() == ""){
      $("#clear_specs_prescription").hide()
    }
    else{
      $("#clear_specs_prescription").show()
    }
  }, 200);
});

$("#clear_specs_prescription").on("click",function(){
  deselected_radiobutton("specs_prescription", "opdrecord_specs_prescription", "");
  $("#clear_specs_prescription").hide()
});

if ($("#opdrecord_fixation_r").val() == ""){
  $("#clear_fixation_r").hide()
} else{
  $("#clear_fixation_r").show()
}

$(".fixation_r").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_fixation_r").val() == ""){
      $("#clear_fixation_r").hide()
    }
    else{
      $("#clear_fixation_r").show()
    }
  }, 200);
});

$("#clear_fixation_r").on("click",function(){
  deselected_radiobutton("fixation_r", "opdrecord_fixation_r", "");
  $("#clear_fixation_r").hide()
});


if ($("#opdrecord_fixation_l").val() == ""){
  $("#clear_fixation_l").hide()
} else{
  $("#clear_fixation_l").show()
}

$(".fixation_l").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_fixation_l").val() == ""){
      $("#clear_fixation_l").hide()
    }
    else{
      $("#clear_fixation_l").show()
    }
  }, 200);
});

$("#clear_fixation_l").on("click",function(){
  deselected_radiobutton("fixation_l", "opdrecord_fixation_l", "");
  $("#clear_fixation_l").hide()
});

if ($("#opdrecord_distance").val() == ""){
  $("#clear_distance").hide()
} else{
  $("#clear_distance").show()
}

$(".distance").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_distance").val() == ""){
      $("#clear_distance").hide()
    }
    else{
      $("#clear_distance").show()
    }
  }, 200);
});

$("#clear_distance").on("click",function(){
  deselected_radiobutton("distance", "opdrecord_distance", "");
  $("#clear_distance").hide()
});

if ($("#opdrecord_near").val() == ""){
  $("#clear_near").hide()
} else{
  $("#clear_near").show()
}

$(".near").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_near").val() == ""){
      $("#clear_near").hide()
    }
    else{
      $("#clear_near").show()
    }
  }, 200);
});

$("#clear_near").on("click",function(){
  deselected_radiobutton("near", "opdrecord_near", "");
  $("#clear_near").hide()
});

if($("#opdrecord_cover_test_distance").length == 1){
  if ($("#opdrecord_cover_test_distance").val() == ""){
    $("#clear_cover_test_distance").hide()
  } else{
    $("#clear_cover_test_distance").show()
    let values = $("#opdrecord_cover_test_distance").val().split(",")
    if(values.length == 2){
      $("#cover_test_distance_1").val(values[0].trim())
      $("#cover_test_distance_2").val(values[1].trim())
    }else if(values.length == 1 && (values[0][0] == "H")){
      $("#cover_test_distance_2").val(values[0].trim())
    }else if(values.length == 1 && (values[0][0] == "E")){
      $("#cover_test_distance_1").val(values[0].trim())
    }
  }
}

$(".cover_test_distance").on("change",function(){
  let cover_test_distance_1 = "", cover_test_distance_2 = "", cover_test_distance_value = ""
  if($("#cover_test_distance_1").val() != ""){
    cover_test_distance_1 = $("#cover_test_distance_1").val()
  }
  if($("#cover_test_distance_2").val() != "") {
    cover_test_distance_2 = $("#cover_test_distance_2").val()
  }
  if(cover_test_distance_1 != "" && cover_test_distance_2 != ""){
    cover_test_distance_value = cover_test_distance_1 + ", " + cover_test_distance_2
  }else if(cover_test_distance_2 != "") {
    cover_test_distance_value = cover_test_distance_2
  }else if(cover_test_distance_1 != ""){
    cover_test_distance_value = cover_test_distance_1
  }
  if(cover_test_distance_value != ""){
    $("#clear_cover_test_distance").show()
  }else{
    $("#clear_cover_test_distance").hide()
  }
  $("#opdrecord_cover_test_distance").val(cover_test_distance_value)
});

$("#clear_cover_test_distance").on("click",function(){
  $("#opdrecord_cover_test_distance").val("")
  $(".cover_test_distance").val("")
  $(this).hide()
});

if($("#opdrecord_cover_test_near").length == 1){
  if ($("#opdrecord_cover_test_near").val() == ""){
    $("#clear_cover_test_near").hide()
  } else{
    $("#clear_cover_test_near").show()
    let values = $("#opdrecord_cover_test_near").val().split(",")
    if(values.length == 2){
      $("#cover_test_near_1").val(values[0].trim())
      $("#cover_test_near_2").val(values[1].trim())
    }else if(values.length == 1 && (values[0][0] == "H")){
      $("#cover_test_near_2").val(values[0].trim())
    }else if(values.length == 1 && (values[0][0] == "E")){
      $("#cover_test_near_1").val(values[0].trim())
    }
  }
}

$(".cover_test_near").on("change",function(){
  let cover_test_near_1 = "", cover_test_near_2 = "", cover_test_near_value = ""
  if($("#cover_test_near_1").val() != ""){
    cover_test_near_1 = $("#cover_test_near_1").val()
  }
  if($("#cover_test_near_2").val() != "") {
    cover_test_near_2 = $("#cover_test_near_2").val()
  }
  if(cover_test_near_1 != "" && cover_test_near_2 != ""){
    cover_test_near_value = cover_test_near_1 + ", " + cover_test_near_2
  }else if(cover_test_near_2 != "") {
    cover_test_near_value = cover_test_near_2
  }else if(cover_test_near_1 != ""){
    cover_test_near_value = cover_test_near_1
  }
  if(cover_test_near_value != ""){
    $("#clear_cover_test_near").show()
  }else{
    $("#clear_cover_test_near").hide()
  }
  $("#opdrecord_cover_test_near").val(cover_test_near_value)
});

$("#clear_cover_test_near").on("click",function(){
  $("#opdrecord_cover_test_near").val("")
  $(".cover_test_near").val("")
  $(this).hide()
});


if ($("#opdrecord_stereopsis_chart").val() == ""){
  $("#clear_stereopsis_chart").hide()
} else{
  $("#clear_stereopsis_chart").show()
}

$(".stereopsis_chart").on("click",function(){
  setTimeout(function(){
    if ($("#opdrecord_stereopsis_chart").val() == ""){
      $("#clear_stereopsis_chart").hide()
    }
    else{
      $("#clear_stereopsis_chart").show()
    }
  }, 200);
});

$("#clear_stereopsis_chart").on("click",function(){
  deselected_radiobutton("stereopsis_chart", "opdrecord_stereopsis_chart", "");
  $("#clear_stereopsis_chart").hide()
});

jQuery(".saveopdrecord").on("click", function() {
  if($("#opdrecord_squint_evaluation").val() == 'No'){
    clear_squint_values()
  }
});

function validate_squint_values(){
  if($("#opdrecord_r_squint_select_1").val() != "" && $('#opdrecord_r_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_1')
  } else if($("#opdrecord_r_squint_select_1").val() == "" && $('#opdrecord_r_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_1')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_1')
    remove_box_shadow('opdrecord_r_squint_select_1')
  }

  if($("#opdrecord_r_squint_select_2").val() != "" && $('#opdrecord_r_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_2')
  } else if($("#opdrecord_r_squint_select_2").val() == "" && $('#opdrecord_r_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_2')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_2')
    remove_box_shadow('opdrecord_r_squint_select_2')
  }

  if($("#opdrecord_r_squint_select_3").val() != "" && $('#opdrecord_r_squint_input_3').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_3')
  } else if($("#opdrecord_r_squint_select_3").val() == "" && $('#opdrecord_r_squint_input_3').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_3')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_3')
    remove_box_shadow('opdrecord_r_squint_select_3')
  }

  if($("#opdrecord_r_squint_select_4").val() != "" && $('#opdrecord_r_squint_input_4').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_4')
  } else if($("#opdrecord_r_squint_select_4").val() == "" && $('#opdrecord_r_squint_input_4').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_4')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_4')
    remove_box_shadow('opdrecord_r_squint_select_4')
  }

  if($("#opdrecord_r_squint_select_5").val() != "" && $('#opdrecord_r_squint_input_5').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_5')
  } else if($("#opdrecord_r_squint_select_5").val() == "" && $('#opdrecord_r_squint_input_5').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_5')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_5')
    remove_box_shadow('opdrecord_r_squint_select_5')
  }

  if($("#opdrecord_r_squint_select_6").val() != "" && $('#opdrecord_r_squint_input_6').val() == ""){
    add_box_shadow('opdrecord_r_squint_input_6')
  } else if($("#opdrecord_r_squint_select_6").val() == "" && $('#opdrecord_r_squint_input_6').val() != ""){
    add_box_shadow('opdrecord_r_squint_select_6')
  } else{
    remove_box_shadow('opdrecord_r_squint_input_6')
    remove_box_shadow('opdrecord_r_squint_select_6')
  }

  if($("#opdrecord_m_squint_select_1").val() != "" && $('#opdrecord_m_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_1')
  } else if($("#opdrecord_m_squint_select_1").val() == "" && $('#opdrecord_m_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_1')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_1')
    remove_box_shadow('opdrecord_m_squint_select_1')
  }

  if($("#opdrecord_m_squint_select_2").val() != "" && $('#opdrecord_m_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_2')
  } else if($("#opdrecord_m_squint_select_2").val() == "" && $('#opdrecord_m_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_2')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_2')
    remove_box_shadow('opdrecord_m_squint_select_2')
  }

  if($("#opdrecord_m_squint_select_3").val() != "" && $('#opdrecord_m_squint_input_3').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_3')
  } else if($("#opdrecord_m_squint_select_3").val() == "" && $('#opdrecord_m_squint_input_3').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_3')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_3')
    remove_box_shadow('opdrecord_m_squint_select_3')
  }

  if($("#opdrecord_m_squint_select_4").val() != "" && $('#opdrecord_m_squint_input_4').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_4')
  } else if($("#opdrecord_m_squint_select_4").val() == "" && $('#opdrecord_m_squint_input_4').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_4')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_4')
    remove_box_shadow('opdrecord_m_squint_select_4')
  }

  if($("#opdrecord_m_squint_select_5").val() != "" && $('#opdrecord_m_squint_input_5').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_5')
  } else if($("#opdrecord_m_squint_select_5").val() == "" && $('#opdrecord_m_squint_input_5').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_5')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_5')
    remove_box_shadow('opdrecord_m_squint_select_5')
  }

  if($("#opdrecord_m_squint_select_6").val() != "" && $('#opdrecord_m_squint_input_6').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_6')
  } else if($("#opdrecord_m_squint_select_6").val() == "" && $('#opdrecord_m_squint_input_6').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_6')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_6')
    remove_box_shadow('opdrecord_m_squint_select_6')
  }

  if($("#opdrecord_m_squint_select_7").val() != "" && $('#opdrecord_m_squint_input_7').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_7')
  } else if($("#opdrecord_m_squint_select_7").val() == "" && $('#opdrecord_m_squint_input_7').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_7')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_7')
    remove_box_shadow('opdrecord_m_squint_select_7')
  }

  if($("#opdrecord_m_squint_select_8").val() != "" && $('#opdrecord_m_squint_input_8').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_8')
  } else if($("#opdrecord_m_squint_select_8").val() == "" && $('#opdrecord_m_squint_input_8').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_8')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_8')
    remove_box_shadow('opdrecord_m_squint_select_8')
  }

  if($("#opdrecord_m_squint_select_9").val() != "" && $('#opdrecord_m_squint_input_9').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_9')
  } else if($("#opdrecord_m_squint_select_9").val() == "" && $('#opdrecord_m_squint_input_9').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_9')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_9')
    remove_box_shadow('opdrecord_m_squint_select_9')
  }

  if($("#opdrecord_m_squint_select_10").val() != "" && $('#opdrecord_m_squint_input_10').val() == ""){
    add_box_shadow('opdrecord_m_squint_input_10')
  } else if($("#opdrecord_m_squint_select_10").val() == "" && $('#opdrecord_m_squint_input_10').val() != ""){
    add_box_shadow('opdrecord_m_squint_select_10')
  } else{
    remove_box_shadow('opdrecord_m_squint_input_10')
    remove_box_shadow('opdrecord_m_squint_select_10')
  }

  if($("#opdrecord_l_squint_select_9").val() != "" && $('#opdrecord_l_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_1')
  } else if($("#opdrecord_l_squint_select_9").val() == "" && $('#opdrecord_l_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_9')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_1')
    remove_box_shadow('opdrecord_l_squint_select_9')
  }

  if($("#opdrecord_l_squint_select_10").val() != "" && $('#opdrecord_l_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_2')
  } else if($("#opdrecord_l_squint_select_10").val() == "" && $('#opdrecord_l_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_10')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_2')
    remove_box_shadow('opdrecord_l_squint_select_10')
  }

  if($("#opdrecord_l_squint_select_11").val() != "" && $('#opdrecord_l_squint_input_3').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_3')
  } else if($("#opdrecord_l_squint_select_11").val() == "" && $('#opdrecord_l_squint_input_3').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_11')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_3')
    remove_box_shadow('opdrecord_l_squint_select_11')
  }

  if($("#opdrecord_l_squint_select_12").val() != "" && $('#opdrecord_l_squint_input_4').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_4')
  } else if($("#opdrecord_l_squint_select_12").val() == "" && $('#opdrecord_l_squint_input_4').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_12')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_4')
    remove_box_shadow('opdrecord_l_squint_select_12')
  }

  if($("#opdrecord_l_squint_select_13").val() != "" && $('#opdrecord_l_squint_input_5').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_5')
  } else if($("#opdrecord_l_squint_select_13").val() == "" && $('#opdrecord_l_squint_input_5').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_13')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_5')
    remove_box_shadow('opdrecord_l_squint_select_13')
  }

  if($("#opdrecord_l_squint_select_14").val() != "" && $('#opdrecord_l_squint_input_6').val() == ""){
    add_box_shadow('opdrecord_l_squint_input_6')
  } else if($("#opdrecord_l_squint_select_14").val() == "" && $('#opdrecord_l_squint_input_6').val() != ""){
    add_box_shadow('opdrecord_l_squint_select_14')
  } else{
    remove_box_shadow('opdrecord_l_squint_input_6')
    remove_box_shadow('opdrecord_l_squint_select_14')
  }

  if($("#opdrecord_near_squint_select_1").val() != "" && $('#opdrecord_near_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_near_squint_input_1')
  } else if($("#opdrecord_near_squint_select_1").val() == "" && $('#opdrecord_near_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_near_squint_select_1')
  } else{
    remove_box_shadow('opdrecord_near_squint_input_1')
    remove_box_shadow('opdrecord_near_squint_select_1')
  }

  if($("#opdrecord_near_squint_select_2").val() != "" && $('#opdrecord_near_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_near_squint_input_2')
  } else if($("#opdrecord_near_squint_select_2").val() == "" && $('#opdrecord_near_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_near_squint_select_2')
  } else{
    remove_box_shadow('opdrecord_near_squint_input_2')
    remove_box_shadow('opdrecord_near_squint_select_2')
  }

  if($("#opdrecord_pd_squint_select_1").val() != "" && $('#opdrecord_pd_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_pd_squint_input_1')
  } else if($("#opdrecord_pd_squint_select_1").val() == "" && $('#opdrecord_pd_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_pd_squint_select_1')
  } else{
    remove_box_shadow('opdrecord_pd_squint_input_1')
    remove_box_shadow('opdrecord_pd_squint_select_1')
  }

  if($("#opdrecord_pd_squint_select_2").val() != "" && $('#opdrecord_pd_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_pd_squint_input_2')
  } else if($("#opdrecord_pd_squint_select_2").val() == "" && $('#opdrecord_pd_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_pd_squint_select_2')
  } else{
    remove_box_shadow('opdrecord_pd_squint_input_2')
    remove_box_shadow('opdrecord_pd_squint_select_2')
  }

  if($("#opdrecord_sd_squint_select_1").val() != "" && $('#opdrecord_sd_squint_input_1').val() == ""){
    add_box_shadow('opdrecord_sd_squint_input_1')
  } else if($("#opdrecord_sd_squint_select_1").val() == "" && $('#opdrecord_sd_squint_input_1').val() != ""){
    add_box_shadow('opdrecord_sd_squint_select_1')
  } else{
    remove_box_shadow('opdrecord_sd_squint_input_1')
    remove_box_shadow('opdrecord_sd_squint_select_1')
  }

  if($("#opdrecord_sd_squint_select_2").val() != "" && $('#opdrecord_sd_squint_input_2').val() == ""){
    add_box_shadow('opdrecord_sd_squint_input_2')
  } else if($("#opdrecord_sd_squint_select_2").val() == "" && $('#opdrecord_sd_squint_input_2').val() != ""){
    add_box_shadow('opdrecord_sd_squint_select_2')
  } else{
    remove_box_shadow('opdrecord_sd_squint_input_2')
    remove_box_shadow('opdrecord_sd_squint_select_2')
  }
}

function add_box_shadow(input_fieldid){
  jQuery("#" + input_fieldid).css('border','2px solid #f59494');
}

function remove_box_shadow(input_fieldid){
  jQuery("#" + input_fieldid).css('border','1px solid #ccc');
}

$(".squint_input").on("change",function(){
  validate_squint_values()
});

$(".squint_select").on("change",function(){
  validate_squint_values()
});

function clear_squint_values(){
  deselected_radiobutton("specs_prescription", "opdrecord_specs_prescription", "");
  deselected_radiobutton("head_posture", "opdrecord_head_posture", "");
  deselected_radiobutton("face_turn", "opdrecord_face_turn", "");
  deselected_radiobutton("head_tilt", "opdrecord_head_tilt", "");

  $("#clear_specs_prescription").hide()
  deselected_radiobutton("fixation_r", "opdrecord_fixation_r", "");
  $("#clear_fixation_r").hide()
  deselected_radiobutton("fixation_l", "opdrecord_fixation_l", "");
  $("#clear_fixation_l").hide()
  deselected_radiobutton("distance", "opdrecord_distance", "");
  $("#clear_distance").hide()
  deselected_radiobutton("near", "opdrecord_near", "");
  $("#clear_near").hide()
  deselected_radiobutton("cover_test_distance", "opdrecord_cover_test_distance", "");
  $("#clear_cover_test_distance").hide()
  deselected_radiobutton("cover_test_near", "opdrecord_cover_test_near", "");
  $("#clear_cover_test_near").hide()
  $(".stereopsis").val('')
  deselected_radiobutton("stereopsis_chart", "opdrecord_stereopsis_chart", "");
  $("#clear_stereopsis_chart").hide()
  $(".squint_input").val('')
  $(".squint_select").val('')
  $('#opdrecord_cover_test_distance').val('')
  $('#opdrecord_head_tilt_degree').val('')
  $('#opdrecord_face_turn_degree').val('')
  $('#opdrecord_head_posture_degree').val('')
  $('#opdrecord_cover_test_near').val('')
  $("#opdrecord_r_hirschberg_test").val('')
  $("#opdrecord_l_hirschberg_test").val('')
  $("#opdrecord_squintcomments").val('')
}
// Squint Section Js Ends

  // JS for, If Optometrist Template is reflected on eye template...follow JS is Required

    // Right
    $(".editViewActivate_r").on('click', function(e){
      e.preventDefault();
      $(this).closest('.mainview_top_r').children(".editview_toggle_r").css("display","block");
      $(this).closest('.mainview_top_r').siblings().children().children().removeClass('data-empty')
      $(this).closest('.mainview_top_r').siblings().children().removeClass('data-empty')
      $(this).closest('.mainview_top_r').siblings().children().find('.rvacopybutton').show()
      $(this).closest('.mainview_top_r').siblings().children().find('.rcopybutton').show()
      $(this).closest('.showview_full_r').hide();
      if ($("#opdrecord_r_contrastsensitivity").val() == ""){
        $("#clear_r_contrastsensitivity").hide()
      }
      else{
        $("#clear_r_contrastsensitivity").show()
      }
    })

    // Left
    $(".editViewActivate_l").on('click', function(e){
      e.preventDefault();
      $(this).closest('.mainview_top_l').children(".editview_toggle_l").css("display","block");
      $(this).closest('.mainview_top_l').siblings().children().children().removeClass('data-empty')
      $(this).closest('.mainview_top_l').siblings().children().removeClass('data-empty')
      $(this).closest('.mainview_top_l').siblings().children().find('.lvacopybutton').show()
      $(this).closest('.mainview_top_l').siblings().children().find('.lcopybutton').show()
      $(this).closest('.showview_full_l').hide();

      if ($("#opdrecord_l_contrastsensitivity").val() == ""){
        $("#clear_l_contrastsensitivity").hide()
      }
      else{
        $("#clear_l_contrastsensitivity").show()
      }

      console.log($(this).parent().parent().parent().attr("class").split(" ")[1])
      var editViewClass = $(this).parent().parent().parent().attr("class").split(" ")[1].replace('l-','r-')
      $("." + editViewClass).find(".editViewActivate_r").trigger("click")

      // triggering for r - side glass prescriptions
      if ($(this).parents(".questionsforacceptance").hasClass("questionsforacceptance")){
        if ($(this).parents(".mainview_top_l").hasClass("l-answersforglassesprescriptions")){
          $(".questionsforacceptance").find(".editViewActivate_r:eq(0)").trigger("click")
        }
        else {
          $(".questionsforacceptance").find(".editViewActivate_r:eq(1)").trigger("click")
        }
      }
    })

  $(".copyfieldsbutton").on('click',function(e){
    e.preventDefault();
    $(".show_glasses_prescription_on_copy").trigger("click");
  })

  jQuery('tbody').on('click', "a[name*='addnewpostoprecordbutton']", function() {
    var fieldcounter;
    if (jQuery(".post-op-record-table-body-added > .postoprecords").length == 0){
        fieldcounter = 0;
    } else {
        fieldcounter = jQuery(".post-op-record-table-body-added > .postoprecords").length;
    }
    var params = { counter: fieldcounter };
    jQuery.ajax({
        type: "GET",
        dataType: "script",
        url: "/opd_records/add_post_op_record",
        data: {ajax: params, remote: "true" },
        async: false,
        success: function(){
            // taper_form();
            // _add_button_at_last()
        }
    });

    if ($('.post-op-record-table-body-added').find('.removepostoprecordbutton').length > 1){
      $('.post-op-record-table-body-added').find('.removepostoprecordbutton').show()
    }
    _renumber_id_after_remove("tbody.post-op-record-table-body-added", "div.post-op-record-table-body-removed");
  });

  jQuery('.post-op-record-table-body-added').on('click', "a[name*='removepostoprecordbutton']", function() {
    event.preventDefault();
    var postop_removed_tr_html;
    var fieldcounter;
    fieldcounter = jQuery(this).attr('id').slice(-1);
    var postop_tr_array = jQuery(this).parents('.postoprecords').find(".id");
    if (postop_tr_array.length > 0) {
        jQuery(this).parents('.postoprecords').find("input[name*='_destroy']").val("1");
        postop_removed_tr_html = jQuery(this).parents('.postoprecords').wrap('<p/>').parent().html();
        jQuery(this).parents('.postoprecords').unwrap();
        jQuery('.post-op-record-table-body-removed').append(postop_removed_tr_html);
        jQuery(this).parents('.postoprecords').remove();
        _renumber_id_after_remove("tbody.post-op-record-table-body-added", "div.post-op-record-table-body-removed");
    } else {
        jQuery(this).parents('.postoprecords').remove();
        _renumber_id_after_remove("tbody.post-op-record-table-body-added", "div.post-op-record-table-body-removed");
    }
    // _add_button_at_last()
    if ($('.post-op-record-table-body-added').find('.removepostoprecordbutton').length == 1){
      $('.post-op-record-table-body-added').find('.removepostoprecordbutton').hide()
    }
  });

  datepicker_options1 = {
    dateFormat: "dd/mm/yy",
    maxDate: 0
  };

  jQuery('.post_operative_day_datepicker').live('focus', function(){
    $(this).datepicker(datepicker_options1);
  });

  $('.surgery_name').autocomplete({
    minLength: 2,
    source: function(request, response) {
      $.ajax({
        dataType: "json",
        type: 'get',
        url: '/common_procedures/search',
        data: {
          search: request.term,
          remote: "true" },
        success: function(data) {
          response(data);
        },
        error: function(data) {
        }
      });
    }
  });

// head posture clear remove
  if ($("#opdrecord_head_posture").val() == ""){
    $("#clear_head_posture").hide()
    $("#opdrecord_head_posture_degree").hide()
    $(".head_posture_degree_label").hide()
  }
  else{
    $("#clear_head_posture").show()
    $("#opdrecord_head_posture_degree").show()
    $(".head_posture_degree_label").show()
  }

  $("#clear_head_posture").on("click",function(){
    deselected_radiobutton("head_posture", "opdrecord_head_posture", "");
    $(this).hide()
    $("#opdrecord_head_posture_degree").hide()
    $(".head_posture_degree_label").hide()
    $("#opdrecord_head_posture_degree").val('')
  });

  $(".head_posture").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_head_posture").val() == ""){
        $("#clear_head_posture").hide()
        $("#opdrecord_head_posture_degree").hide()
        $(".head_posture_degree_label").show()
      }
      else{
        $("#clear_head_posture").show()
        $("#opdrecord_head_posture_degree").show()
        $(".head_posture_degree_label").show()
      }
    }, 200);
  });
// head posture end


// face turn clear remove
  if ($("#opdrecord_face_turn").val() == ""){
    $("#clear_face_turn").hide()
    $(".face_turn_degree_label").hide()
    $("#opdrecord_face_turn_degree").hide()
  }
  else{
    $("#clear_face_turn").show()
    $(".face_turn_degree_label").show()
    $("#opdrecord_face_turn_degree").show()
  }

  $("#clear_face_turn").on("click", function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("face_turn", "opdrecord_face_turn", "");
    $(this).hide()
    $("#opdrecord_face_turn").val("")
    $("#opdrecord_face_turn_degree").hide()
    $(".face_turn_degree_label").hide()
    $("#opdrecord_face_turn_degree").val("")
  });

  $(".face_turn").on("click", function(){
    setTimeout(function(){
      if ($("#opdrecord_face_turn").val() == ""){
        $("#clear_face_turn").hide()
        $(".face_turn_degree_label").hide()
        $("#opdrecord_face_turn_degree").hide()
      }
      else{
        $("#clear_face_turn").show()
        $(".face_turn_degree_label").show()
        $("#opdrecord_face_turn_degree").show()
      }
    }, 200);
  });

// face turn end



// head_tilt clear remove
  if ($("#opdrecord_head_tilt").val() == ""){
    $("#clear_head_tilt").hide()
    $(".head_tilt_degree_label").hide()
    $("#opdrecord_head_tilt_degree").hide()
  }
  else{
    $("#clear_head_tilt").show()
    $(".head_tilt_degree_label").show()
    $("#opdrecord_head_tilt_degree").show()
  }

  $("#clear_head_tilt").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("head_tilt", "opdrecord_head_tilt", "");
    $(this).hide()
    $("#opdrecord_head_tilt_degree").hide()
    $(".head_tilt_degree_label").hide()
    $("#opdrecord_head_tilt_degree").val("")
    $("#opdrecord_head_tilt").val("")
  });

  $(".head_tilt").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_head_tilt").val() == ""){
        $("#clear_head_tilt").hide()
        $(".head_tilt_degree_label").hide()
        $("#opdrecord_head_tilt_degree").hide()
      }
      else{

        $("#clear_head_tilt").show()
        $(".head_tilt_degree_label").show()
        $("#opdrecord_head_tilt_degree").show()
      }
    }, 200);
  });

// face turn end

// r_hirschberg_test clear remove
  if ($("#opdrecord_r_hirschberg_test").length == 1){
    if ($("#opdrecord_r_hirschberg_test").val() == ""){
      $("#clear_r_hirschberg_test").hide()
      $(".r_hirschberg_test").val("")
    }
    else{
      $("#clear_r_hirschberg_test").show()
      let values = $("#opdrecord_r_hirschberg_test").val().split(",")
      if(values.length == 2){
        $("#r_hirschberg_test_1").val(values[0].trim())
        $("#r_hirschberg_test_2").val(values[1].trim())
      }else if(values.length == 1 && (values[0].includes("Hyper") || values[0].includes("Hypo"))){
        $("#r_hirschberg_test_2").val(values[0].trim())
      }else if(values.length == 1 && (values[0].includes("Eso") || values[0].includes("Exo") || values[0].includes("Normal"))){
        $("#r_hirschberg_test_1").val(values[0].trim())
      }
    }
  }

  $("#clear_r_hirschberg_test").on("click",function(){
    $(this).hide()
    $(".r_hirschberg_test").val("")
    $("#opdrecord_r_hirschberg_test").val("")
  });

  $(".r_hirschberg_test").on("change",function(){
    let r_hirschberg_test_1 = $("#r_hirschberg_test_1").val(), r_hirschberg_test_2 = $("#r_hirschberg_test_2").val(), r_hirschberg_test_value = ""
    if(r_hirschberg_test_1 === "Normal"){
      if($(this).attr('id') == 'r_hirschberg_test_1'){
        r_hirschberg_test_value = r_hirschberg_test_1
        $("#r_hirschberg_test_2").val('')
      }else{
        r_hirschberg_test_value = r_hirschberg_test_2
        $("#r_hirschberg_test_1").val('')
      }
    }else if(r_hirschberg_test_1 != "" && r_hirschberg_test_2 != ""){
      r_hirschberg_test_value = r_hirschberg_test_1 + ", " + r_hirschberg_test_2
    }else if(r_hirschberg_test_2 != "") {
      r_hirschberg_test_value = r_hirschberg_test_2
    }else if(r_hirschberg_test_1 != ""){
      r_hirschberg_test_value = r_hirschberg_test_1
    }
    if(r_hirschberg_test_value != ""){
      $("#clear_r_hirschberg_test").show()
    }else{
      $("#clear_r_hirschberg_test").hide()
    }
    $("#opdrecord_r_hirschberg_test").val(r_hirschberg_test_value)
  })

// face turn end


// r_patterns clear remove
  if ($("#opdrecord_r_patterns").val() == ""){
    $("#clear_r_patterns").hide()
  }
  else{
    $("#clear_r_patterns").show()
  }

  $("#clear_r_patterns").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("r_patterns", "opdrecord_r_patterns", "");
    $(this).hide()
  });

  $(".r_patterns").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_r_patterns").val() == ""){
        $("#clear_r_patterns").hide()
      }
      else{

        $("#clear_r_patterns").show()
      }
    }, 200);
  });

// face turn end


// r_patterns clear remove
  if ($("#opdrecord_r_prism_bar_cover_test").val() == ""){
    $("#clear_r_prism_bar_cover_test").hide()
  }
  else{
    $("#clear_r_prism_bar_cover_test").show()
  }

  $("#clear_r_prism_bar_cover_test").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("r_prism_bar_cover_test", "opdrecord_r_prism_bar_cover_test", "");
    $(this).hide()
  });

  $(".r_prism_bar_cover_test").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_r_prism_bar_cover_test").val() == ""){
        $("#clear_r_prism_bar_cover_test").hide()
      }
      else{

        $("#clear_r_prism_bar_cover_test").show()
      }
    }, 200);
  });

// face turn end

// r_patterns clear remove
  if ($("#opdrecord_r_prism_bar_reflex_test").val() == ""){
    $("#clear_r_prism_bar_reflex_test").hide()
  }
  else{
    $("#clear_r_prism_bar_reflex_test").show()
  }

  $("#clear_r_prism_bar_reflex_test").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("r_prism_bar_reflex_test", "opdrecord_r_prism_bar_reflex_test", "");
    $(this).hide()
  });

  $(".r_prism_bar_reflex_test").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_r_prism_bar_reflex_test").val() == ""){
        $("#clear_r_prism_bar_reflex_test").hide()
      }
      else{

        $("#clear_r_prism_bar_reflex_test").show()
      }
    }, 200);
  });

// face turn end



// r_hirschberg_test clear remove
  if($("#opdrecord_l_hirschberg_test").length == 1){
    if ($("#opdrecord_l_hirschberg_test").val() == ""){
      $("#clear_l_hirschberg_test").hide()
      $(".l_hirschberg_test").val("")
    }
    else{
      $("#clear_l_hirschberg_test").show()
      let values = $("#opdrecord_l_hirschberg_test").val().split(",")
      if(values.length == 2){
        $("#l_hirschberg_test_1").val(values[0].trim())
        $("#l_hirschberg_test_2").val(values[1].trim())
      }else if(values.length == 1 && (values[0].includes("Hyper") || values[0].includes("Hypo"))){
        $("#l_hirschberg_test_2").val(values[0].trim())
      }else if(values.length == 1 && (values[0].includes("Eso") || values[0].includes("Exo") || values[0].includes("Normal"))){
        $("#l_hirschberg_test_1").val(values[0].trim())
      }
    } 
  }

  $("#clear_l_hirschberg_test").on("click",function(){
    $(this).hide()
    $(".l_hirschberg_test").val("")
    $("#opdrecord_l_hirschberg_test").val("")
  });

  $(".l_hirschberg_test").on("change",function(){
    let l_hirschberg_test_1 = $("#l_hirschberg_test_1").val(), l_hirschberg_test_2 = $("#l_hirschberg_test_2").val(), l_hirschberg_test_value = ""
    if($("#l_hirschberg_test_1").val() === "Normal"){
      if($(this).attr('id') == 'l_hirschberg_test_1'){
        l_hirschberg_test_value = l_hirschberg_test_1
        $("#l_hirschberg_test_2").val('')
      }else{
        l_hirschberg_test_value = l_hirschberg_test_2
        $("#l_hirschberg_test_1").val('')
      }
    }else if(l_hirschberg_test_1 != "" && l_hirschberg_test_2 != ""){
      l_hirschberg_test_value = l_hirschberg_test_1 + ", " + l_hirschberg_test_2
    }else if(l_hirschberg_test_2 != "") {
      l_hirschberg_test_value = l_hirschberg_test_2
    }else if(l_hirschberg_test_1 != ""){
      l_hirschberg_test_value = l_hirschberg_test_1
    }
    if(l_hirschberg_test_value != ""){
      $("#clear_l_hirschberg_test").show()
    }else{
      $("#clear_l_hirschberg_test").hide()
    }
    $("#opdrecord_l_hirschberg_test").val(l_hirschberg_test_value)
  })

// r_patterns clear remove
  if ($("#opdrecord_l_patterns").val() == ""){
    $("#clear_l_patterns").hide()
  }
  else{
    $("#clear_l_patterns").show()
  }

  $("#clear_l_patterns").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("l_patterns", "opdrecord_l_patterns", "");
    $(this).hide()
  });

  $(".l_patterns").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_l_patterns").val() == ""){
        $("#clear_l_patterns").hide()
      }
      else{

        $("#clear_l_patterns").show()
      }
    }, 200);
  });

// face turn end

// r_patterns clear remove
  if ($("#opdrecord_l_prism_bar_cover_test").val() == ""){
    $("#clear_l_prism_bar_cover_test").hide()
  }
  else{
    $("#clear_l_prism_bar_cover_test").show()
  }

  $("#clear_l_prism_bar_cover_test").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("l_prism_bar_cover_test", "opdrecord_l_prism_bar_cover_test", "");
    $(this).hide()
  });

  $(".l_prism_bar_cover_test").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_l_prism_bar_cover_test").val() == ""){
        $("#clear_l_prism_bar_cover_test").hide()
      }
      else{

        $("#clear_l_prism_bar_cover_test").show()
      }
    }, 200);
  });

// face turn end

// r_patterns clear remove
  if ($("#opdrecord_l_prism_bar_reflex_test").val() == ""){
    $("#clear_l_prism_bar_reflex_test").hide()
  }
  else{
    $("#clear_l_prism_bar_reflex_test").show()
  }

  $("#clear_l_prism_bar_reflex_test").on("click",function(){
    // ('field_class_name', 'field_name', 'value')
    deselected_radiobutton("l_prism_bar_reflex_test", "opdrecord_l_prism_bar_reflex_test", "");
    $(this).hide()
  });

  $(".l_prism_bar_reflex_test").on("click",function(){
    setTimeout(function(){
      if ($("#opdrecord_l_prism_bar_reflex_test").val() == ""){
        $("#clear_l_prism_bar_reflex_test").hide()
      }
      else{

        $("#clear_l_prism_bar_reflex_test").show()
      }
    }, 200);
  });

// face turn end
var summernote_options = {
    toolbar: [],
    height: 60
};

$('.opdrecord_summernote').summernote(summernote_options)

$( ".opdrecord_summernote" ).each(function( index ) {
  if ($(this).summernote('isEmpty'))
  {
    $(this).code('')
  }
});

$('#rconfroncopybutton').on('click', function(){
  jQuery(".l-answersforconfrontation").show();
  $("#buttontoggle-opdrecord_l_confrontation > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_r_confrontation = jQuery("#opdrecord_r_confrontation").val();
  jQuery("#opdrecord_l_confrontation").attr("value", opdrecord_r_confrontation);
  let r_confrontation_comments = $('#opdrecord_r_confrontation_comments').code()
  $('#opdrecord_l_confrontation_comments').code(r_confrontation_comments)
})

$('#lconfroncopybutton').on('click', function(){
  jQuery(".r-answersforconfrontation").show();
  $("#buttontoggle-opdrecord_r_confrontation > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_l_confrontation = jQuery("#opdrecord_l_confrontation").val();
  jQuery("#opdrecord_r_confrontation").attr("value", opdrecord_l_confrontation);
  let l_confrontation_comments = $('#opdrecord_l_confrontation_comments').code()
  $('#opdrecord_r_confrontation_comments').code(l_confrontation_comments)
})

$('#rcolorvisioncopybutton').on('click', function(){
  jQuery(".l-answersforcolorvision").show();
  $("#buttontoggle-opdrecord_l_colorvision > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_r_colorvision = jQuery("#opdrecord_r_colorvision").val();
  jQuery("#opdrecord_l_colorvision").attr("value", opdrecord_r_colorvision);
  let r_colorvision_comments = $('#opdrecord_r_colorvision_comments').code()
  $('#opdrecord_l_colorvision_comments').code(r_colorvision_comments)
})

$('#lcolorvisioncopybutton').on('click', function(){
  jQuery(".r-answersforcolorvision").show();
  $("#buttontoggle-opdrecord_r_colorvision > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_l_colorvision = jQuery("#opdrecord_l_colorvision").val();
  jQuery("#opdrecord_r_colorvision").attr("value", opdrecord_l_colorvision);
  let l_colorvision_comments = $('#opdrecord_l_colorvision_comments').code()
  $('#opdrecord_r_colorvision_comments').code(l_colorvision_comments)
})

$('#rcontrasenstivitycopybutton').on('click', function(){
  jQuery(".l-answersforcontrasenstivity").show();
  $("#buttontoggle-opdrecord_l_contrasenstivity > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_r_contrasenstivity = jQuery("#opdrecord_r_contrasenstivity").val();
  jQuery("#opdrecord_l_contrasenstivity").attr("value", opdrecord_r_contrasenstivity);
  let r_contrasenstivity_comments = $('#opdrecord_r_contrasenstivity_comments').code()
  $('#opdrecord_l_contrasenstivity_comments').code(r_contrasenstivity_comments)
})

$('#lcontrasenstivitycopybutton').on('click', function(){
  jQuery(".r-answersforcontrasenstivity").show();
  $("#buttontoggle-opdrecord_r_contrasenstivity > span").attr('class','glyphicon glyphicon-minus-sign')
  let opdrecord_l_contrasenstivity = jQuery("#opdrecord_l_contrasenstivity").val();
  jQuery("#opdrecord_r_contrasenstivity").attr("value", opdrecord_l_contrasenstivity);
  let l_contrasenstivity_comments = $('#opdrecord_l_contrasenstivity_comments').code()
  $('#opdrecord_r_contrasenstivity_comments').code(l_contrasenstivity_comments)
})

$('#ramslercopybutton').click(function(){
  let opdrecord_r_amsler_comments = $('#opdrecord_r_amsler_comments').code()
  $('#opdrecord_l_amsler_comments').code(opdrecord_r_amsler_comments)
  var radio_array = ['opdrecord_r_amsler']
  $(this).parent().parent().parent().next().find('input,select,textarea').each(function(){
    alert('in if');
    var a = $(this);
    if (a.attr('id')) {
      var r_id =  a.attr('id');
      var l_id =  a.attr('id').replace('_l_','_r_');
      var r_val = $('#'+r_id).val();
      $('#'+l_id).val(r_val)

      if (radio_array.includes(r_val)) {
        copy_selected_radiobutton(l_id.replace('opdrecord_',''), l_id , r_val);
      }
    }
  });
});

$('#lamslercopybutton').click(function(){
  let opdrecord_l_amsler_comments = $('#opdrecord_l_amsler_comments').code()
  $('#opdrecord_r_amsler_comments').code(opdrecord_l_amsler_comments)
  var radio_array = ['opdrecord_l_amsler']
  $(this).parent().parent().parent().next().find('input,select,textarea').each(function(){
    var a = $(this);
    if (a.attr('id')) {
      var l_id =  a.attr('id');
      var r_id =  a.attr('id').replace('_l_','_r_');
      var l_val = $('#'+l_id).val();
      $('#'+r_id).val(l_val)

      if (radio_array.includes(l_val)) {
        copy_selected_radiobutton(r_id.replace('opdrecord_',''), r_id , l_val);
      }
    }
  });
});

function copy_selected_radiobutton(fieldname, input_fieldname, value) {
  var flag = 0;
  jQuery.each(jQuery("." + fieldname), function(index, button) {
    if (jQuery(button).attr("input-value") === value) {
      jQuery(button).addClass("btn-brown");
      jQuery(button).trigger('click')
      flag = 1;
      jQuery("#" + input_fieldname).val(value);
    } else {
      jQuery(button).removeClass("btn-brown");
      jQuery("#" + input_fieldname).val(value).change()
    }
  });
}

function show_or_hide_scleracommon(side, value) {
  if (value === "Normal" || value.length === 0) {
    $("."+side+"-answersforsclera").hide();
    empty_comment_textbox(side+"_scleracommon_comments", "opdrecord_"+side+"_scleracommon_comments");
    $("#buttontoggle-opdrecord_"+side+"_scleracommon > span").attr('class','glyphicon glyphicon-plus-sign')
  }
  else if (value !== "Normal") {
    $("."+side+"-answersforsclera").show();
    $("#buttontoggle-opdrecord_"+side+"_scleracommon > span").attr('class','glyphicon glyphicon-minus-sign')
  }
}

