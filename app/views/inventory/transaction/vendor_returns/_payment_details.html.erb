<% currency_symbol = (current_facility.currency_symbol) %>
<div class="col-md-12">
  <div class="col-md-6">
    <div class="row">
      <div class="col-sm-8">
        <%= f.text_area :comments, class: 'form-control', placeholder: 'Comments' %>
      </div>
      <div class="col-md-4"></div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="row">
      <div class="col-sm-12">
        <div class="col-sm-6">
          <b>Amount Before Tax</b>
        </div>
        <div class="col-sm-2 text-center">
          :
        </div>
        <div class="col-sm-4">
          <span><%= text_field_tag :total_cost, '', class: 'form-control p7_10 return-total-cost', readonly: true, name: 'inventory_transaction_vendor_return[total_cost]', id: 'inventory_transaction_vendor_return_total_cost', placeholder: "Total Cost" %></span>
        </div>
      </div>
    </div>
    <div class="row" id="purchase_return_tax"></div>
    <%= hidden_field_tag :tax_amount, '', class: 'form-control p7_10 return-total-cost', readonly: true, name: 'inventory_transaction_vendor_return[tax_amount]', id: 'inventory_transaction_vendor_return_tax_amount', placeholder: "Total Cost" %>
    <!--  <div class="row">
      <div class="col-sm-12">
        <div class="col-sm-6">
          <b>Tax</b>
        </div>
        <div class="col-sm-2 text-center">
          :
        </div>
        <div class="col-sm-4">
          <span></span>
        </div>
      </div>
    </div> -->
   <!--  <div class="row">
      <div class="col-sm-12">
        <div class="col-sm-6">
          <b>Return Discount</b>
        </div>
        <div class="col-sm-2 text-center">
          :
        </div>
        <div class="col-sm-4">
          <span><%#= text_field_tag :return_discount, '', class: 'form-control p7_10 return-changes', id: 'inventory_transaction_vendor_return_return_discount', name: 'inventory_transaction_vendor_return[return_discount]', placeholder: "Return Discount", onkeypress: 'return isNumberKey(this, event)' %></span>
        </div>
      </div>
    </div> -->
    <div class="row">
      <div class="col-sm-12">
        <div class="col-sm-6">
          <b>Net Return With Tax</b>
        </div>
        <div class="col-sm-2 text-center">
          :
        </div>
        <div class="col-sm-4">
          <span><%= text_field_tag :return_amount, '', class: 'form-control p7_10 return-amount', id: 'inventory_transaction_vendor_return_return_amount', name: 'inventory_transaction_vendor_return[return_amount]', readonly: true, placeholder: "Return Amount" %></span>
        </div>
      </div>
    </div>
    <%= hidden_field_tag :paid_amount, '', class: 'form-control p7_10 paid_amount', id: 'inventory_transaction_vendor_return_paid_amount', name: 'inventory_transaction_vendor_return[paid_amount]', placeholder: "Amount" %>
    <%= hidden_field_tag :debit_amount, '', class: 'form-control p7_10 credit-amount', id: 'inventory_transaction_vendor_return_debit_amount', name: 'inventory_transaction_vendor_return[debit_amount]', readonly: true, placeholder: "Credit Amount" %>
    <!-- <div class="pending_amount_details">
      <div class="row">
        <div class="col-sm-12">
          <div class="col-sm-6">
            <b>Amount to be Returned</b>
          </div>
          <div class="col-sm-2 text-center">
            :
          </div>
          <div class="col-sm-4">
            <span><%#= text_field_tag :paid_amount, '', class: 'form-control p7_10 paid_amount', id: 'inventory_transaction_vendor_return_paid_amount', name: 'inventory_transaction_vendor_return[paid_amount]', placeholder: "Amount" %></span>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="col-sm-6">
            <b>Credit Amount</b>
          </div>
          <div class="col-sm-2 text-center">
            :
          </div>
          <div class="col-sm-4">
            <span><%#= text_field_tag :debit_amount, '', class: 'form-control p7_10 credit-amount', id: 'inventory_transaction_vendor_return_debit_amount', name: 'inventory_transaction_vendor_return[debit_amount]', readonly: true, placeholder: "Credit Amount" %></span>
          </div>
        </div>
      </div>
    </div> -->
  </div>
</div>

<div class="row">
  <!-- <div class="col-md-2"></div>
  <div class="rdio rdio-primary col-md-5">
    <%#= f.radio_button "full_settlement", true, {:class => 'full_settlement', :id => "full_settlement_now"} %>
    <label for="full_settlement_now">Full Payment</label>
  </div>
  <div class="rdio rdio-primary col-md-5">
    <%#= f.radio_button "full_settlement", false, {:class => 'full_settlement', :id => "full_settlement_pending"} %>
    <label for="full_settlement_pending">Partial Payment</label>
  </div> -->
</div>

<div class="row mb5" style="border-bottom:1px solid #eee;border-top:1px solid #eee; margin-top: 5px;">
  <!-- <div class="row">
    <div class="col-md-8">
      <h5>PAYMENT DETAILS</h5>
    </div>
    <div class="col-md-2 mb5">
      <b style="color: red">Balance/Pending</b><br>
      <input type="text" name="total_payment_remaining" class="form-control total_payment_remaining p3_10" id="total_payment_remaining" value="0" readonly="readonly">
    </div>
    <div class="col-md-2 mb5">
      <b style="color: green">Received</b><br>
      <input type="text" name="total_payment" class="form-control total_payment p3_10" id="total_payment" value="0" readonly="readonly">
    </div>
  </div>
  <div id="payment-details" style="border: 1px solid #aaa;padding: 20px;">
    <div id="payment-received-form">
      <div class="row payment-received-details">
        <div class="col-md-10 mb5">
          <b style="text-decoration: underline;">PAYMENT RECEIVED DETAILS</b>
        </div>
        <div class="col-md-2 mb5 text-right">
          <div class="input-group">
            <span class="input-group-addon" style="padding: 5px 10px;font-size:10px;"><%= currency_symbol %></span>
            <input type="text" name="inventory_transaction_vendor_return[payment_received]" class="form-control invoice_payment_received p3_10" id="payment_received_total" value="<%#= @inventory_invoice.payment_received %>" readonly="readonly">
          </div>
        </div>
        <div class="col-md-12">
          <div class="row received-description">
            <div class="col-md-1">
              <b>S.No.</b>
            </div>
            <div class="col-md-2">
              <b>Mode of Payment</b>
            </div>
            <div class="col-md-3">
              <b>Date</b>
            </div>
            <div class="col-md-3">
              <b>Time</b>
            </div>
            <div class="col-md-2">
              <b>Amount</b>
            </div>
          </div>
          <div id="payment_received_details">
            <div class="row payment_received_row mb10">
                <input type="hidden" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][received_by]" class="form-control payment_received_breakups_received_by p3_10" value="<%= @vendor.id.to_s %>">
                <input type="hidden" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][received_from]" class="form-control payment_received_breakups_received_from p3_10" value="<%= current_user.id.to_s %>">
                <input type="hidden" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][currency_id]" class="form-control payment_received_breakups_currency_id p3_10" value="<%= current_facility.currency_id.to_s %>">
                <div class="col-md-1">
                  <span class="payment_received_breakups_sno">1.</span>
                </div>
                <div class="col-md-2">
                  <% mop_list = Invoice::InvoicesHelper.mop_list(current_facility.country_id)%>
                  <select class="form-control payment_received_breakups_mode_of_payment" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][mode_of_payment]" style="height: 25px;padding:3px;" data-index="0">
                    <option value=""></option>
                    <% mop_list.each do |mop| %>
                      <option value="<%= mop %>"><%= mop %></option>
                    <% end %>
                  </select>
                </div>
                <div class="col-md-3">
                  <input type="text" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][date]" class="form-control payment_received_breakups_date p3_10" value="<%= Date.current %>" readonly="readonly">
                  <!- Date.current.strftime('%d/%m/%Y')  -- commented line>
                </div>
                <div class="col-md-3">
                  <div class="bootstrap-timepicker timepicker">
                    <input type="text" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][time]" class="form-control payment_received_breakups_time p3_10" value="<%= Time.current.strftime('%I:%M %p') %>" readonly="readonly">
                  </div>
                </div>
                <div class="col-md-2">
                  <div class="input-group">
                    <span class="input-group-addon" style="padding: 5px 10px;font-size:10px;"><%= currency_symbol %></span>
                    <input type="number" name="inventory_transaction_vendor_return[payment_received_breakups_attributes][0][amount]" class="form-control payment_received_breakups_amount p3_10" min="0" value="0">
                  </div>
                </div>
                <div class="col-md-1">
                  <button class="btn btn-link btn-xs remove_payment_received">&times;</button>
                </div>
                <div class="col-md-4 col-md-offset-3 mt10 mop_details" style="display: none;border: 1px solid #ccc;padding: 5px;">
                </div>
              </div>
          </div>
          <div class="row">
            <button class="btn btn-link btn-xs" id="add_payment_received">Add Payment</button>
          </div>
          <div class="payment_pending_details">
            <div class="mb5" style="border-bottom:1px solid #eee;border-top:1px solid #eee; margin-top: 5px;"></div>
            <div class="row">
              <div class="col-md-10 mb5">
                <b style="text-decoration: underline;">PAYMENT PENDING DETAILS</b>&emsp;<b style="color: red; font-size: 11px; font-style: italic;">* The Amount that this vendor owes you</b>
              </div>
              <div class="col-md-2 mb5 text-right">
                <div class="input-group">
                  <span class="input-group-addon" style="padding: 5px 10px;font-size:10px;"><%= currency_symbol %></span>
                  <input type="text" name="" class="form-control p3_10" id="total_debit_amount" value="<%#= @inventory_invoice.payment_received %>" readonly="readonly">
                </div>
              </div>
              <div class="col-md-12">
                <div class="row received-description">
                  <div class="col-md-1">
                    <b>S.No.</b>
                  </div>
                  <div class="col-md-2">
                    <b>Payer</b>
                  </div>
                  <div class="col-md-3">
                    <b>Date</b>
                  </div>
                  <div class="col-md-3">
                    <b>Time</b>
                  </div>
                  <div class="col-md-2">
                    <b>Amount</b>
                  </div>
                </div>
                <div id="payer_received_details">
                  <div class="col-md-1">
                    <span class="payment_received_breakups_sno">1.</span>
                  </div>
                  <div class="col-md-2">
                    <input type="text" name="inventory_transaction_vendor_return[vendor_name]" class="form-control payment_received_breakups_vendor p3_10" value="<%= @vendor.name %>" readonly="readonly" style="margin-left: -10px;">
                  </div>
                  <div class="col-md-3">
                    <input type="text" name="" class="form-control payment_received_breakups_date p3_10" value="<%= Date.current.strftime('%d/%m/%Y') %>" readonly="readonly" style="margin-left: -5px;">
                  </div>
                  <div class="col-md-3">
                    <div class="bootstrap-timepicker timepicker">
                      <input type="text" name="" class="form-control payment_received_breakups_time p3_10" value="<%= Time.current.strftime('%I:%M %p') %>">
                    </div>
                  </div>
                  <div class="col-md-2">
                    <div class="input-group">
                      <span class="input-group-addon" style="padding: 5px 10px;font-size:10px;"><%= currency_symbol %></span>
                      <input type="number" name="inventory_transaction_vendor_return[debit_amount]" class="form-control payment-received-credit-amount p3_10" id="payment_received_debit_amount">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
 -->
<script type="text/javascript">
  function isNumberKey(txt, evt) {
    var charCode = (evt.which) ? evt.which : evt.keyCode;
    if (charCode == 46) {
      //Check if the text already contains the . character
      if (txt.value.indexOf('.') === -1) {
        return true;
      } else {
        return false;
      }
    } else {
      if (charCode > 31 &&
        (charCode < 48 || charCode > 57))
        return false;
    }
    return true;
  }
</script>