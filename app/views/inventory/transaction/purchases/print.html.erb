<div style="border:1px solid #ccc;">
  <div class="row" style="border-bottom:1px solid #ccc;">
    <div class="col-md-12" style="border-bottom:1px solid #ccc;">
      <% entity_name = @entity_name.present? ? @entity_name : @inventory_store.name %>
      <h5 style="text-align: center;"><%= entity_name %></h5>
    </div>
    <div class="row" style="border-bottom:1px solid #ccc;">
      <div class="col-md-3 text-left">
        <% if @inventory_store.asset_path.url %>
          <% unless @inventory_store.asset_path.url.split('/').last == '_old_' %>
            <img class="img-fluid" width="80" height="60" src="<%= @inventory_store.asset_path.url %>">
          <% end %>
        <%end%>
      </div>
      <div class="col-sm-6 text-center">
        <% unless @inventory_store.address == 'org-address' %>
          <h5 style="margin: 0px"><%= @inventory_store.address %></h5>
        <%end%>
        <% if @inventory_store.email.present? %>
          <p> <h5 style="margin: 0px"><%= @inventory_store.email %></h5> </p>
        <%end%>
        <% if @inventory_store.mobilenumber.present? %>
          <p> <h5 style="margin: 0px"><%= @inventory_store.mobilenumber %></h5> </p>
        <%end%>
      </div>
      <div class="col-sm-3 text-center">
        <%# if @inventory_store.name ==nil || @inventory_store.name == "" || @inventory_store.shop_name == 'org-name' %>
          <!-- <h3 style="margin:0px"><%#= current_facility.name %></h3> -->
        <%#else%>
          <!-- <h3 style="margin:0px"><%#= @inventory_store.shop_name %></h3> -->
        <%#end%>
      </div>
    </div>

    <div class="row" style="border-bottom:1px solid #ccc;display: flex;height: 100%;">
      <div class="col-md-7 text-right">
        <b style="color: #00BFFF;">GOODS RECEIVED NOTE</b>
      </div>
      <div class="col-md-1"></div>
      <div class="col-md-4 offset-md-1">
        <div>
          <span>GSTIN:&emsp;<%=  @inventory_store.gst.present? ? @inventory_store.gst : "NA"  %></span>
        </div>
      </div>
      <div class="row" style="border-bottom:1px solid #ccc;"></div>

      <div class="row" style="border-bottom:1px solid #ccc;">
        <div class="col-md-4" style="border-right:1px solid #ccc;">
          <div class="col-md-12 check_font"><span>To:&emsp;</span></div>
          <div class="col-md-12 check_font"><span><b>Vendor Name:</b>&emsp;<%= @purchase.vendor_location_name %></span></div>
          <div class="col-md-12 check_font"><span><b>Vendor Address:</b>&emsp;<%= @purchase.vendor_location_address %></span></div>
        </div>
        <div class="col-md-8" >
           <% if @purchase_order_transaction.present? %>
            <div class="col-md-5 check_font"><span><b>P.O NO.:</b>&emsp;<%= @purchase_order_transaction.purchase_display_id %></span></div>
            <div class="col-md-7 check_font"><span class="check_date"><b>P.O TIME:</b>&emsp;<%= @purchase_order_transaction.order_date_time.try(:strftime, '%d-%m-%Y') %>&nbsp;&nbsp;|&nbsp;&nbsp;<%= @purchase_order_transaction.order_date_time&.strftime("%I:%M %p")%></span></div>
            <% end %>
          <% if @purchase.bill_number.present? %>
            <div class="col-md-5 check_font"><span><b>BILL NO.:</b>&emsp;<%= @purchase.bill_number %></span></div>
            <div class="col-md-7 check_font"><span class="check_date"><b>BILL TIME:</b>&emsp;<%= @purchase.bill_date.try(:strftime, '%d-%m-%Y') %>&nbsp;&nbsp;|&nbsp;&nbsp;<%= @purchase.created_at&.strftime("%I:%M %p")%></span></div>
            <% else %>
             <div class="col-md-5 check_font"><span><b>CHALLAN NO.:</b>&emsp;<%= @purchase.challan_number %></span></div>
            <div class="col-md-7 check_font"><span class="check_date"><b>CHALLAN TIME:</b>&emsp;<%= @purchase.challan_date.try(:strftime, '%d-%m-%Y') %>&nbsp;&nbsp;|&nbsp;&nbsp;<%= @purchase.created_at&.strftime("%I:%M %p")%></span></div>
          <% end %>
          <% if @purchase_order_transaction&.po_expiry_date.present? %>
            <div class="col-md-12 check_font"><span><b>EXPIRY DATE:</b>&emsp;<%= @purchase_order_transaction.po_expiry_date.try(:strftime, '%d-%m-%Y') %></span></div>
          <% end %>
        </div>
      </div>
      <div class="col-md-4" style="border-right:1px solid #ccc;padding-right: 7px;">
        <div class="check_font"><span><b>Vendor GSTIN:</b>&emsp;<%= @purchase.vendor_gst_number.present? ?  @purchase.vendor_gst_number : "NA" %></span></div>
      </div>
      <div class="col-md-8">
         <div class="check_font"><span ><b>Transaction ID:</b>&emsp;<%= @purchase.purchase_display_id.present? ? @purchase.purchase_display_id : "NA" %></span></div>
      </div>
    </div>
    <div class="row" style=" display: flex;">
      <!-- <div class="col-md-4 check_font" style="border-right:1px solid #ccc;">
        <div class="row">
          <div class="col-md-5">
             <div><span><b>BILL TO:</b></span></div>
          </div>
          <div class="col-md-7">
            <div><%#= "Amazon store" %></div>
            <div><span><%#="A.B Road Sarangpur,Infront of anil pertol pump's"%></span></div>
          </div>
        </div>
      </div>
      <div class="col-md-8 check_font" >
        <div class="row">
          <div class="col-md-2">
             <div><span><b>SHIP TO:</b></span></div>
          </div>
          <div class="col-md-10">
            <div> <%#="Indore Shop" %></div>
            <div><span><%#= "715&801, Pukhraj Corporate, near Hotel Prashant, Navlakha, Indore, Navlakha, Indore"%></span></div>
          </div>
        </div>
      </div>
      <div class="col-md-12" style="border-bottom:1px solid #ccc;"></div> -->

      <!-- <div class="row mt10 mb5 mb7">
        <div class="row mb5 col-md-12">
          <div class="col-md-6 font_size"><span>Vendor:&emsp;<%#= @purchase.vendor_name%></span></div>
          <div class="col-md-6 font_size"><span>Date|Time:&emsp;<%#= @purchase.transaction_date.try(:strftime, '%Y-%m-%d') %>&nbsp;&nbsp;|&nbsp;&nbsp;<%#= @purchase.created_at&.strftime("%I:%M%p")%></span></div>
        </div>
      </div> -->
      <!-- <div class="row mt10 mb5 mb7">
        <div class="row mb5 col-md-12">
          <%# if @vendor_location.dl_number.present? %>
            <div class="col-md-6 font_size">
              <span>DL Number:&emsp;<%#= @vendor_location.dl_number %></span>
            </div>
          <%# end %>
          <%# if @vendor_location.gst_number.present? %>
            <div class="col-md-6 font_size">
              <span>GST:&emsp;<%#= @vendor_location.gst_number %></span>
            </div>
          <%# end %>
        </div>
      </div> -->
      <!-- <div class="row mt10 mb5 mb7" style="border-bottom:1px solid #ccc;">
        <div class="row mb5 col-md-12">
          <div class="col-md-6 font_size">
            <span>Transaction ID:&emsp;<%#= @purchase.purchase_display_id %></span>
          </div>
        </div>
      </div> -->
      <!-- <div class="col-md-12" ></div> -->
    <div class="col-lg-12 col-md-12 col-sm-12" style="padding: 0">
      <!-- <h4 style="margin-top:0;">Transaction Details&nbsp; -->
        <div class="row check_font">
          <table class="table table-striped table-bordered">
            <thead>
              <tr>
               <!--  <th width="15%" style="font-weight: bold;">S No.</th>
                <th width="15%;" style="font-weight: bold;">HSN</th>
                <th width="25%" style="font-weight: bold;">Description</th>
                <th width="15%" style="font-weight: bold;">Qty.</th>
                <th width="15%" style="font-weight: bold;">Free Qty.</th>
                <th width="15%" style="font-weight: bold;">Tax</th>
                <th width="20%" style="font-weight: bold;">Rate</th>
                <th width="20%" style="font-weight: bold;">Batch</th>
                <th width="20%" style="font-weight: bold;">MRP</th>
                <th width="30%" style="font-weight: bold;">Expiry</th>
                <th width="15%" style="font-weight: bold;">Discount</th>
                <th width="25%" style="font-weight: bold;">Amount</th> -->
                <th  style="font-weight: bold;">S No.</th>
                <th  style="font-weight: bold;">HSN</th>
                <th  style="font-weight: bold;">Description</th>
                <th  style="font-weight: bold;">Qty.</th>
                <th  style="font-weight: bold;">Free Qty.</th>
                <th  style="font-weight: bold;">Tax</th>
                <th  style="font-weight: bold;">Rate</th>
                <th  style="font-weight: bold;">Batch No.</th>
                <th  style="font-weight: bold;">MRP</th>
                <th  style="font-weight: bold;">Expiry</th>
                <th  style="font-weight: bold;">Discount</th>
                <th  style="font-weight: bold;">Amount</th>
                <th  style="font-weight: bold;">Remark</th>
              </tr>
            </thead>
            <tbody>
              <% @count = 1 %>
              <% @purchase.items.each do |item| %>
                <tr>
                  <td><%= @count %></td>
                  <% hsn_no = Inventory::Item.find_by(id: item.item_id.to_s).try(:hsn_no).present? ? Inventory::Item.find_by(id: item.item_id.to_s).hsn_no : 'NA' %>
                  <td><%= hsn_no%></td>
                  <td><%= "#{item.description}" %></td>
                  <td><%= item.paid_stock %></td>
                  <td><%= item.stock_free_unit %></td>
                  <td><%= item.tax_rate %></td>
                  <td><%= item.unit_cost_without_tax %></td>
                  <td><%= item.batch_no %></td>
                  <td><%= item.list_price %></td>
                  <td><%= item.expiry.try(:strftime, '%d-%m-%Y') %></td>
                  <td><%= item.item_discount || 0 %></td>
                  <td><%= item.total_cost&.round(2) %></td>
                  <td><%= item.remarks %></td>
                </tr>
                 <% @count += 1 %>
              <% end %>
            </tbody>
          </table>
        </div>
      </h4>
    </div>
    <div id="item_information" class="col-lg-12 col-md-12 col-sm-12">
      <div class="col-md-4">
        <% if @purchase.other_charges&.present? %>
          <div class="check_font" style="margin-top:0;font-weight: bold;">Other Charges:&nbsp;</div>
          <div class="row check_font">
            <table class="table table-borderless">
              <tbody>
                <% @count = 1 %>
                <% @purchase.other_charges.each do |charge| %>
                  <tr>
                    <td><%= @count %></td>
                    <td><%= charge[:name] %></td>
                    <td><%= charge[:net_amount].include?('-') ? '-' : '+' %>&nbsp;&nbsp;<%= charge[:amount] %></td>
                  </tr>
                <% @count += 1 %>
                <% end %>
              </tbody>
            </table>
          </div>
        <% end %>
      </div>
      <div class="col-md-7 col-md-offset-1">
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Gross Amount</b>
          </div>
          <div class="col-sm-1 text-center check_font">
            :
          </div>
          <div class="col-sm-2 check_font">
            <%= @purchase.total_cost.to_f.round(2) %>
          </div>
        </div>
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Total Discount</b>
          </div>
          <div class="col-sm-1 text-center check_font">
            :
          </div>
          <div class="col-sm-2 check_font" id="discount">
            <%= @purchase.discount %>
          </div>
        </div>
        <% tax_d = {} %>
        <% @purchase.items.try(:each) do |item| %>
          <% if (tax_d[item.tax_name] == nil) %>
            <% tax_d[item.tax_name] = item.purchase_tax_amount.to_f %>
          <% else %>
            <%  tax_d[item.tax_name] = tax_d[item.tax_name].to_f + item.purchase_tax_amount.to_f %>
          <% end %>   
        <% end %>
        <% tax_d.each do |tax_breakup| %>
          <div class="col-sm-12 text-right">
            <div class="col-sm-7 check_font">
              <b><%= tax_breakup[0] %></b>
            </div>
            <div class="col-sm-1 text-center check_font">
              :
            </div>
            <div class="col-sm-2 check_font">
              <%= number_with_precision(tax_breakup[1], precision: 2) %>
            </div>
          </div>
        <% end %>
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Other Charges</b>
          </div>
          <div class="col-sm-1 text-center check_font">
            :
          </div>
          <div class="col-sm-2 check_font">
            <%= @purchase.total_other_charges_amount || 0 %>
          </div>
        </div>
        <div class="col-sm-12 text-right">
          <% if false %>
            <div class="col-sm-7 check_font">
              <b>Credit Adjustment</b>
            </div>
            <div class="col-sm-1 text-center check_font">
              :
            </div>
            <div class="col-sm-2 check_font" id="credit_adjustment">
              <%= @purchase.credit_adjustment %>
            </div>
          <% end %>
        </div>
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Net Amount</b>
          </div>
          <div class="col-sm-1 text-center check_font">
            :
          </div>
          <div class="col-sm-2 check_font">
            <%= @purchase.net_amount %>
          </div>
        </div>
        <!-- <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Amount Paid</b>
          </div>
          <div class="col-sm-2 text-center check_font">
            :
          </div>
          <div class="col-sm-1 check_font">
            <%#= @purchase.amount_paid %>
          </div>
        </div>
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Amount Remaining</b>
          </div>
          <div class="col-sm-2 text-center check_font">
            :
          </div>
          <div class="col-sm-1 check_font">
            <%#= @purchase.amount_remaining %>
          </div>
        </div> -->
        <!-- <div class="row mb5" style="border-bottom:1px solid #eee; margin-top: 5px;"></div>
        <div class="col-sm-12 text-right">
          <div class="col-sm-7 check_font">
            <b>Taxable Amount</b>
          </div>
          <div class="col-sm-2 text-center check_font">
            :
          </div>
          <div class="col-sm-1 check_font">
            <%#= @purchase.purchase_taxable_amount %>
          </div>
        </div> -->
        <%# @purchase.tax_breakup.try(:each) do |tax_breakup| %>
          <!-- <div class="col-sm-12 text-right">
            <div class="col-sm-7 check_font">
              <b><%#= tax_breakup[:name] %></b>
            </div>
            <div class="col-sm-2 text-center check_font">
              :
            </div>
            <div class="col-sm-1 check_font">
              <%#= number_with_precision(tax_breakup[:amount], precision: 2) %>
            </div>
          </div> -->
        <%# end %>
      </div>
    </div>
  </div>
</div>


<style type="text/css">
  .table-add-item td{
    padding: 5px 5px 0;
  }

  .check_font table tr th {
    padding: 5px 8px;
    background-color: #4CAF50;
    color: white;
    text-align: center;
  }

  .check_font table tr td {
    padding: 5px 8px;
    text-align: center;
  }

  .check_font {
    font-size: 11px;
  }
  .table-borderless tr td {
    border: none !important;
    /*padding:  1px 1px 0 !important;*/
  }
</style>
